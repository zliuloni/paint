/*
 * 
 *                  xxxxxxx      xxxxxxx
 *                   x:::::x    x:::::x 
 *                    x:::::x  x:::::x  
 *                     x:::::xx:::::x   
 *                      x::::::::::x    
 *                       x::::::::x     
 *                       x::::::::x     
 *                      x::::::::::x    
 *                     x:::::xx:::::x   
 *                    x:::::x  x:::::x  
 *                   x:::::x    x:::::x 
 *              THE xxxxxxx      xxxxxxx TOOLKIT
 *                    
 *                  http://www.goXTK.com
 *                   
 * Copyright (c) 2012 The X Toolkit Developers <dev@goXTK.com>
 *                   
 *    The X Toolkit (XTK) is licensed under the MIT License:
 *      http://www.opensource.org/licenses/mit-license.php
 * 
 *      "Free software" is a matter of liberty, not price.
 *      "Free" as in "free speech", not as in "free beer".
 *                                         - Richard M. Stallman
 * 
 * FUELED BY:
 *  - the wonderful Constructive Solid Geometry library by Evan Wallace (http://madebyevan.com)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/csg/LICENSE
 *
 *  - parts of the Google Closure Library (http://code.google.com/closure/library)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/closure-library/LICENSE
 * 
 *  - the JSXCompressor library (http://jsxgraph.uni-bayreuth.de/wp/jsxcompressor/)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/JXG/LICENSE
 *
 * MORE CREDITS: https://raw.github.com/xtk/X/master/LICENSE
 *
 */
function i(a){throw a;}var m=void 0,o=!0,q=null,r=!1;function aa(){return function(){}}function ba(a){return function(b){this[a]=b}}function t(a){return function(){return this[a]}}var u,ca=this;function da(){}
function ea(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function fa(a){return a!==m}function y(a){return a!=q}function C(a){return"array"==ea(a)}function ha(a){var b=ea(a);return"array"==b||"object"==b&&"number"==typeof a.length}function ia(a){return"string"==typeof a}function D(a){return"number"==typeof a}function ja(a){return"function"==ea(a)}function ka(a){a=ea(a);return"object"==a||"array"==a||"function"==a}function la(a){return a[ma]||(a[ma]=++na)}
var ma="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36),na=0;function oa(a,b,c){return a.call.apply(a.bind,arguments)}function pa(a,b,c){a||i(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function qa(a,b,c){qa=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?oa:pa;return qa.apply(q,arguments)}function ra(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}var ua=Date.now||function(){return+new Date};
function E(a,b){var c=a.split("."),d=ca;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&fa(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}function H(a,b){function c(){}c.prototype=b.prototype;a.k=b.prototype;a.prototype=new c;a.prototype.constructor=a};function va(a,b,c){this.xa=this.wa=this.va=0;3==arguments.length?(this.va=Number(a),this.wa=Number(b),this.xa=Number(c)):a instanceof va?(this.va=Number(a.x()),this.wa=Number(a.y()),this.xa=Number(a.b())):(this.va=Number(a[0]),this.wa=Number(a[1]),this.xa=Number(a[2]))}
va.prototype={f:function(){return new va(this.va,this.wa,this.xa)},Ve:function(){return new va(-this.va,-this.wa,-this.xa)},wc:function(a){return new va(this.va+a.x(),this.wa+a.y(),this.xa+a.b())},cd:function(a){return new va(this.va-a.x(),this.wa-a.y(),this.xa-a.b())},Db:function(a){return new va(this.va*a,this.wa*a,this.xa*a)},fh:function(a){return new va(this.va/a,this.wa/a,this.xa/a)},tc:function(a){return this.va*a.x()+this.wa*a.y()+this.xa*a.b()},bg:function(a,b){return this.wc(a.cd(this).Db(b))},
length:function(){return Math.sqrt(this.tc(this))},ld:function(){return this.fh(this.length())},Ee:function(a){return new va(this.wa*a.b()-this.xa*a.y(),this.xa*a.x()-this.va*a.b(),this.va*a.y()-this.wa*a.x())},x:t("va"),y:t("wa"),b:t("xa")};var I=I||{};I.Ui=o;I.Ea=function(a){eval("X.DEV === undefined")||window.console.time(a)};I.ya=function(a){eval("X.DEV === undefined")||window.console.timeEnd(a)};window["X.counter"]=new function(){this.Ng=0;this.Qi=function(){return this.Ng++}};function wa(a,b){for(var c in b){var d=b.__lookupGetter__(c),e=b.__lookupSetter__(c);d||e?(d&&a.__defineGetter__(c,d),e&&a.__defineSetter__(c,e)):a[c]=b[c]}}
Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return f.apply(this instanceof c?this:a||window,e.concat(d.call(arguments)))}function c(){}"function"!==typeof this&&i(new TypeError("Function.prototype.bind - what is trying to be bound is not callable"));var d=Array.prototype.slice,e=d.call(arguments,1),f=this;c.prototype=this.prototype;b.prototype=new c;return b});
(function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.fd;++c)window.fd=window[b[c]+"RequestAnimationFrame"],window.Hd=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.fd||(window.fd=function(b){var c=Date.now(),f=Math.max(0,16-(c-a)),g=window.setTimeout(function(){b(c+f)},f);a=c+f;return g});window.Hd||(window.Hd=function(a){clearTimeout(a)})})();E("Function.prototype.bind",Function.prototype.bind);E("window.requestAnimationFrame",window.fd);
E("window.cancelAnimationFrame",window.Hd);function xa(a){if(!za.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(Aa,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Ba,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Ea,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Fa,"&quot;"));return a}var Aa=/&/g,Ba=/</g,Ea=/>/g,Fa=/\"/g,za=/[&<>\"]/;var Ga,Ha,Ia,Ja,Ka,La,Ma;function Na(){return ca.navigator?ca.navigator.userAgent:q}function Oa(){return ca.navigator}Ka=Ja=Ia=Ha=Ga=r;var Pa;if(Pa=Na()){var Qa=Oa();Ga=0==Pa.indexOf("Opera");Ha=!Ga&&-1!=Pa.indexOf("MSIE");Ja=(Ia=!Ga&&-1!=Pa.indexOf("WebKit"))&&-1!=Pa.indexOf("Mobile");Ka=!Ga&&!Ia&&"Gecko"==Qa.product}var Sa=Ga,L=Ha,Ta=Ka,Ua=Ia,Va=Ja,Wa,Xa=Oa();Wa=Xa&&Xa.platform||"";La=-1!=Wa.indexOf("Mac");Ma=-1!=Wa.indexOf("Win");var Ya=!!Oa()&&-1!=(Oa().appVersion||"").indexOf("X11"),Za;
a:{var ab="",bb;if(Sa&&ca.opera)var cb=ca.opera.version,ab="function"==typeof cb?cb():cb;else if(Ta?bb=/rv\:([^\);]+)(\)|;)/:L?bb=/MSIE\s+([^\);]+)(\)|;)/:Ua&&(bb=/WebKit\/(\S+)/),bb)var db=bb.exec(Na()),ab=db?db[1]:"";if(L){var eb,fb=ca.document;eb=fb?fb.documentMode:m;if(eb>parseFloat(ab)){Za=""+eb;break a}}Za=ab}var gb={};
function hb(a){var b;if(!(b=gb[a])){b=0;for(var c=(""+Za).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=(""+a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",l=RegExp("(\\d*)(\\D*)","g"),k=RegExp("(\\d*)(\\D*)","g");do{var j=l.exec(g)||["","",""],n=k.exec(h)||["","",""];if(0==j[0].length&&0==n[0].length)break;b=((0==j[1].length?0:parseInt(j[1],10))<(0==n[1].length?0:parseInt(n[1],10))?-1:(0==j[1].length?0:parseInt(j[1],
10))>(0==n[1].length?0:parseInt(n[1],10))?1:0)||((0==j[2].length)<(0==n[2].length)?-1:(0==j[2].length)>(0==n[2].length)?1:0)||(j[2]<n[2]?-1:j[2]>n[2]?1:0)}while(0==b)}b=gb[a]=0<=b}return b}var jb={};function kb(a){return jb[a]||(jb[a]=L&&document.documentMode&&document.documentMode>=a)};function lb(a,b){for(var c in a)b.call(m,a[c],c,a)}function mb(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function nb(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}var ob="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",");function rb(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<ob.length;f++)c=ob[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var sb=Array.prototype,tb=sb.indexOf?function(a,b,c){return sb.indexOf.call(a,b,c)}:function(a,b,c){c=c==q?0:0>c?Math.max(0,a.length+c):c;if(ia(a))return!ia(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},ub=sb.forEach?function(a,b,c){sb.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ia(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},vb=sb.map?function(a,b,c){return sb.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=
ia(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},wb=sb.some?function(a,b,c){return sb.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ia(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return o;return r},xb=sb.every?function(a,b,c){return sb.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ia(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return r;return o};function yb(a,b){var c=tb(a,b);0<=c&&sb.splice.call(a,c,1)}
function zb(a){return sb.concat.apply(sb,arguments)}function Ab(a){if(C(a))return zb(a);for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}function Bb(a,b,c){return 2>=arguments.length?sb.slice.call(a,b):sb.slice.call(a,b,c)};function Cb(a){if("function"==typeof a.Ua)a=a.Ua();else if(ha(a)||ia(a))a=a.length;else{var b=0,c;for(c in a)b++;a=b}return a}function Db(a){if("function"==typeof a.La)return a.La();if(ia(a))return a.split("");if(ha(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return mb(a)}
function Eb(a,b){if("function"==typeof a.every)return a.every(b,m);if(ha(a)||ia(a))return xb(a,b,m);var c;if("function"==typeof a.Zc)c=a.Zc();else if("function"!=typeof a.La)if(ha(a)||ia(a)){c=[];for(var d=a.length,e=0;e<d;e++)c.push(e)}else c=nb(a);else c=m;for(var d=Db(a),e=d.length,f=0;f<e;f++)if(!b.call(m,d[f],c&&c[f],a))return r;return o};var Fb="StopIteration"in ca?ca.StopIteration:Error("StopIteration");function Gb(){}Gb.prototype.next=function(){i(Fb)};Gb.prototype.Bc=function(){return this};function Kb(a){if(a instanceof Gb)return a;if("function"==typeof a.Bc)return a.Bc(r);if(ha(a)){var b=0,c=new Gb;c.next=function(){for(;;){b>=a.length&&i(Fb);if(b in a)return a[b++];b++}};return c}i(Error("Not implemented"))}
function Lb(a,b){if(ha(a))try{ub(a,b,m)}catch(c){c!==Fb&&i(c)}else{a=Kb(a);try{for(;;)b.call(m,a.next(),m,a)}catch(d){d!==Fb&&i(d)}}};function Mb(a,b){this.F={};this.v=[];var c=arguments.length;if(1<c){c%2&&i(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.xe(a)}u=Mb.prototype;u.L=0;u.md=0;u.Ua=t("L");u.La=function(){Nb(this);for(var a=[],b=0;b<this.v.length;b++)a.push(this.F[this.v[b]]);return a};u.Zc=function(){Nb(this);return this.v.concat()};u.Ce=function(a){for(var b=0;b<this.v.length;b++){var c=this.v[b];if(Ob(this.F,c)&&this.F[c]==a)return o}return r};
u.Vc=function(a,b){if(this===a)return o;if(this.L!=a.Ua())return r;var c=b||Pb;Nb(this);for(var d,e=0;d=this.v[e];e++)if(!c(this.get(d),a.get(d)))return r;return o};function Pb(a,b){return a===b}u.clear=function(){this.F={};this.md=this.L=this.v.length=0};u.remove=function(a){return Ob(this.F,a)?(delete this.F[a],this.L--,this.md++,this.v.length>2*this.L&&Nb(this),o):r};
function Nb(a){if(a.L!=a.v.length){for(var b=0,c=0;b<a.v.length;){var d=a.v[b];Ob(a.F,d)&&(a.v[c++]=d);b++}a.v.length=c}if(a.L!=a.v.length){for(var e={},c=b=0;b<a.v.length;)d=a.v[b],Ob(e,d)||(a.v[c++]=d,e[d]=1),b++;a.v.length=c}}u.get=function(a,b){return Ob(this.F,a)?this.F[a]:b};u.set=function(a,b){Ob(this.F,a)||(this.L++,this.v.push(a),this.md++);this.F[a]=b};u.xe=function(a){var b;a instanceof Mb?(b=a.Zc(),a=a.La()):(b=nb(a),a=mb(a));for(var c=0;c<b.length;c++)this.set(b[c],a[c])};u.f=function(){return new Mb(this)};
u.Bc=function(a){Nb(this);var b=0,c=this.v,d=this.F,e=this.md,f=this,g=new Gb;g.next=function(){for(;;){e!=f.md&&i(Error("The map has changed since the iterator was created"));b>=c.length&&i(Fb);var g=c[b++];return a?g:d[g]}};return g};function Ob(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function Qb(a){this.F=new Mb;a&&this.xe(a)}function Rb(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+la(a):b.substr(0,1)+a}u=Qb.prototype;u.Ua=function(){return this.F.Ua()};u.add=function(a){this.F.set(Rb(a),a)};u.xe=function(a){for(var a=Db(a),b=a.length,c=0;c<b;c++)this.add(a[c])};u.Yd=function(a){for(var a=Db(a),b=a.length,c=0;c<b;c++)this.remove(a[c])};u.remove=function(a){return this.F.remove(Rb(a))};u.clear=function(){this.F.clear()};
u.contains=function(a){a=Rb(a);return Ob(this.F.F,a)};u.$f=function(a){for(var b=new Qb,a=Db(a),c=0;c<a.length;c++){var d=a[c];this.contains(d)&&b.add(d)}return b};u.La=function(){return this.F.La()};u.f=function(){return new Qb(this)};u.Vc=function(a){return this.Ua()==Cb(a)&&Sb(this,a)};
function Sb(a,b){var c=Cb(b);if(a.Ua()>c)return r;!(b instanceof Qb)&&5<c&&(b=new Qb(b));return Eb(a,function(a){if("function"==typeof b.contains)a=b.contains(a);else if("function"==typeof b.Ce)a=b.Ce(a);else if(ha(b)||ia(b))a=0<=tb(b,a);else a:{for(var c in b)if(b[c]==a){a=o;break a}a=r}return a})}u.Bc=function(){return this.F.Bc(r)};function Tb(){}Tb.prototype.Mf=r;Tb.prototype.Ja=function(){this.Mf||(this.Mf=o,this.M())};Tb.prototype.M=function(){this.bh&&Ub.apply(q,this.bh)};function Vb(a){a&&"function"==typeof a.Ja&&a.Ja()}function Ub(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];ha(d)?Ub.apply(q,d):Vb(d)}};function Wb(a,b){this.dg=b;this.Yc=[];a>this.dg&&i(Error("[goog.structs.SimplePool] Initial cannot be greater than max"));for(var c=0;c<a;c++)this.Yc.push(this.Jd())}H(Wb,Tb);u=Wb.prototype;u.Jf=q;u.Lf=q;function Xb(a,b){a.Yc.length<a.dg?a.Yc.push(b):a.He(b)}u.Jd=function(){return this.Jf?this.Jf():{}};u.He=function(a){if(this.Lf)this.Lf(a);else if(ka(a))if(ja(a.Ja))a.Ja();else for(var b in a)delete a[b]};u.M=function(){Wb.k.M.call(this);for(var a=this.Yc;a.length;)this.He(a.pop());delete this.Yc};function Yb(){this.Wc=[];this.af=new Mb;this.zg=this.Ag=this.Bg=this.wg=0;this.kd=new Mb;this.Gf=this.yg=0;this.We=1;this.Ie=new Wb(0,4E3);this.Ie.Jd=function(){return new Zb};this.xg=new Wb(0,50);this.xg.Jd=function(){return new $b};var a=this;this.Me=new Wb(0,2E3);this.Me.Jd=function(){return""+a.We++};this.Me.He=aa()}function $b(){this.of=this.time=this.count=0}
$b.prototype.toString=function(){var a=[];a.push(this.type," ",this.count," (",Math.round(10*this.time)/10," ms)");this.of&&a.push(" [VarAlloc = ",this.of,"]");return a.join("")};function Zb(){}function ac(a,b,c,d){var e=[];-1==c?e.push("    "):e.push(bc(a.Nf-c));e.push(" ",cc(a.Nf-b));0==a.Je?e.push(" Start        "):1==a.Je?(e.push(" Done "),e.push(bc(a.Mj-a.startTime)," ms ")):e.push(" Comment      ");e.push(d,a);0<a.Mi&&e.push("[VarAlloc ",a.Mi,"] ");return e.join("")}
Zb.prototype.toString=function(){return this.type==q?this.Zg:"["+this.type+"] "+this.Zg};Yb.prototype.reset=function(){for(var a=0;a<this.Wc.length;a++){var b=this.Ie.id;b&&Xb(this.Me,b);Xb(this.Ie,this.Wc[a])}this.Wc.length=0;this.af.clear();this.wg=ua();this.Gf=this.yg=this.zg=this.Ag=this.Bg=0;b=this.kd.Zc();for(a=0;a<b.length;a++){var c=this.kd.get(b[a]);c.count=0;c.time=0;c.of=0;Xb(this.xg,c)}this.kd.clear()};
Yb.prototype.toString=function(){for(var a=[],b=-1,c=[],d=0;d<this.Wc.length;d++){var e=this.Wc[d];1==e.Je&&c.pop();a.push(" ",ac(e,this.wg,b,c.join("")));b=e.Nf;a.push("\n");0==e.Je&&c.push("|  ")}if(0!=this.af.Ua()){var f=ua();a.push(" Unstopped timers:\n");Lb(this.af,function(b){a.push("  ",b," (",f-b.startTime," ms, started at ",cc(b.startTime),")\n")})}b=this.kd.Zc();for(d=0;d<b.length;d++)c=this.kd.get(b[d]),1<c.count&&a.push(" TOTAL ",c,"\n");a.push("Total tracers created ",this.yg,"\n","Total comments created ",
this.Gf,"\n","Overhead start: ",this.Bg," ms\n","Overhead end: ",this.Ag," ms\n","Overhead comment: ",this.zg," ms\n");return a.join("")};function bc(a){var a=Math.round(a),b="";1E3>a&&(b=" ");100>a&&(b="  ");10>a&&(b="   ");return b+a}function cc(a){a=Math.round(a);return(""+(100+a/1E3%60)).substring(1,3)+"."+(""+(1E3+a%1E3)).substring(1,4)}new Yb;function dc(){}var ec=0;u=dc.prototype;u.key=0;u.yc=r;u.ze=r;u.ja=function(a,b,c,d,e,f){ja(a)?this.ag=o:a&&a.handleEvent&&ja(a.handleEvent)?this.ag=r:i(Error("Invalid listener argument"));this.ad=a;this.sg=b;this.src=c;this.type=d;this.capture=!!e;this.Ke=f;this.ze=r;this.key=++ec;this.yc=r};u.handleEvent=function(a){return this.ag?this.ad.call(this.Ke||this.src,a):this.ad.handleEvent.call(this.ad,a)};!L||kb(9);var fc=!L||kb(9),gc=L&&!hb("8");!Ua||hb("528");Ta&&hb("1.9b")||L&&hb("8")||Sa&&hb("9.5")||Ua&&hb("528");!Ta||hb("8");function hc(a,b){this.type=a;this.currentTarget=this.target=b}H(hc,Tb);u=hc.prototype;u.M=function(){delete this.type;delete this.target;delete this.currentTarget};u.ec=r;u.hd=o;u.stopPropagation=function(){this.ec=o};u.preventDefault=function(){this.hd=r};function ic(a){ic[" "](a);return a}ic[" "]=da;function jc(a,b){a&&this.ja(a,b)}H(jc,hc);u=jc.prototype;u.target=q;u.relatedTarget=q;u.offsetX=0;u.offsetY=0;u.clientX=0;u.clientY=0;u.screenX=0;u.screenY=0;u.button=0;u.keyCode=0;u.charCode=0;u.ctrlKey=r;u.altKey=r;u.shiftKey=r;u.metaKey=r;u.Ta=q;
u.ja=function(a,b){var c=this.type=a.type;hc.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(Ta){var e;a:{try{ic(d.nodeName);e=o;break a}catch(f){}e=r}e||(d=q)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=Ua||a.offsetX!==m?a.offsetX:a.layerX;this.offsetY=Ua||a.offsetY!==m?a.offsetY:a.layerY;this.clientX=a.clientX!==m?a.clientX:a.pageX;this.clientY=a.clientY!==m?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.state=a.state;this.Ta=a;delete this.hd;delete this.ec};u.stopPropagation=function(){jc.k.stopPropagation.call(this);this.Ta.stopPropagation?this.Ta.stopPropagation():this.Ta.cancelBubble=o};
u.preventDefault=function(){jc.k.preventDefault.call(this);var a=this.Ta;if(a.preventDefault)a.preventDefault();else if(a.returnValue=r,gc)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};u.oh=t("Ta");u.M=function(){jc.k.M.call(this);this.relatedTarget=this.currentTarget=this.target=this.Ta=q};var kc={},lc={},mc={},nc={};
function M(a,b,c,d,e){if(b){if(C(b)){for(var f=0;f<b.length;f++)M(a,b[f],c,d,e);return q}var d=!!d,g=lc;b in g||(g[b]={L:0,Ca:0});g=g[b];d in g||(g[d]={L:0,Ca:0},g.L++);var g=g[d],h=la(a),l;g.Ca++;if(g[h]){l=g[h];for(f=0;f<l.length;f++)if(g=l[f],g.ad==c&&g.Ke==e){if(g.yc)break;return l[f].key}}else l=g[h]=[],g.L++;f=oc();f.src=a;g=new dc;g.ja(c,f,a,b,d,e);c=g.key;f.key=c;l.push(g);kc[c]=g;mc[h]||(mc[h]=[]);mc[h].push(g);a.addEventListener?(a==ca||!a.Kf)&&a.addEventListener(b,f,d):a.attachEvent(b in
nc?nc[b]:nc[b]="on"+b,f);return c}i(Error("Invalid event type"))}function oc(){var a=pc,b=fc?function(c){return a.call(b.src,b.key,c)}:function(c){c=a.call(b.src,b.key,c);if(!c)return c};return b}function qc(a,b,c,d,e){if(C(b))for(var f=0;f<b.length;f++)qc(a,b[f],c,d,e);else a=M(a,b,c,d,e),kc[a].ze=o}
function rc(a,b,c,d,e){if(C(b))for(var f=0;f<b.length;f++)rc(a,b[f],c,d,e);else{d=!!d;a:{f=lc;if(b in f&&(f=f[b],d in f&&(f=f[d],a=la(a),f[a]))){a=f[a];break a}a=q}if(a)for(f=0;f<a.length;f++)if(a[f].ad==c&&a[f].capture==d&&a[f].Ke==e){sc(a[f].key);break}}}
function sc(a){if(!kc[a])return r;var b=kc[a];if(b.yc)return r;var c=b.src,d=b.type,e=b.sg,f=b.capture;c.removeEventListener?(c==ca||!c.Kf)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in nc?nc[d]:nc[d]="on"+d,e);c=la(c);e=lc[d][f][c];if(mc[c]){var g=mc[c];yb(g,b);0==g.length&&delete mc[c]}b.yc=o;e.hg=o;tc(d,f,c,e);delete kc[a];return o}
function tc(a,b,c,d){if(!d.Ud&&d.hg){for(var e=0,f=0;e<d.length;e++)d[e].yc?d[e].sg.src=q:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.hg=r;0==f&&(delete lc[a][b][c],lc[a][b].L--,0==lc[a][b].L&&(delete lc[a][b],lc[a].L--),0==lc[a].L&&delete lc[a])}}function uc(a){var b,c=0,d=b==q;b=!!b;if(a==q)lb(mc,function(a){for(var e=a.length-1;0<=e;e--){var f=a[e];if(d||b==f.capture)sc(f.key),c++}});else if(a=la(a),mc[a])for(var a=mc[a],e=a.length-1;0<=e;e--){var f=a[e];if(d||b==f.capture)sc(f.key),c++}}
function vc(a){var b=wc,a=la(a),c=mc[a];if(c){var d=fa(b),e=fa(m);return d&&e?(c=lc[b],!!c&&!!c[m]&&a in c[m]):!d&&!e?o:wb(c,function(a){return d&&a.type==b||e&&a.capture==m})}return r}function xc(a,b,c,d,e){var f=1,b=la(b);if(a[b]){a.Ca--;a=a[b];a.Ud?a.Ud++:a.Ud=1;try{for(var g=a.length,h=0;h<g;h++){var l=a[h];l&&!l.yc&&(f&=Bc(l,e)!==r)}}finally{a.Ud--,tc(c,d,b,a)}}return Boolean(f)}function Bc(a,b){var c=a.handleEvent(b);a.ze&&sc(a.key);return c}
function pc(a,b){if(!kc[a])return o;var c=kc[a],d=c.type,e=lc;if(!(d in e))return o;var e=e[d],f,g;if(!fc){var h;if(!(h=b))a:{h=["window","event"];for(var l=ca;f=h.shift();)if(y(l[f]))l=l[f];else{h=q;break a}h=l}f=h;h=o in e;l=r in e;if(h){if(0>f.keyCode||f.returnValue!=m)return o;a:{var k=r;if(0==f.keyCode)try{f.keyCode=-1;break a}catch(j){k=o}if(k||f.returnValue==m)f.returnValue=o}}k=new jc;k.ja(f,this);f=o;try{if(h){for(var n=[],s=k.currentTarget;s;s=s.parentNode)n.push(s);g=e[o];g.Ca=g.L;for(var p=
n.length-1;!k.ec&&0<=p&&g.Ca;p--)k.currentTarget=n[p],f&=xc(g,n[p],d,o,k);if(l){g=e[r];g.Ca=g.L;for(p=0;!k.ec&&p<n.length&&g.Ca;p++)k.currentTarget=n[p],f&=xc(g,n[p],d,r,k)}}else f=Bc(c,k)}finally{n&&(n.length=0),k.Ja()}return f}d=new jc(b,this);try{f=Bc(c,d)}finally{d.Ja()}return f}var Cc=0;function Dc(a){return a+"_"+Cc++};function Ec(){}H(Ec,Tb);u=Ec.prototype;u.Kf=o;u.Wd=q;u.df=ba("Wd");u.addEventListener=function(a,b,c,d){M(this,a,b,c,d)};u.removeEventListener=function(a,b,c,d){rc(this,a,b,c,d)};
u.dispatchEvent=function(a){var b=a.type||a,c=lc;if(b in c){if(ia(a))a=new hc(a,this);else if(a instanceof hc)a.target=a.target||this;else{var d=a,a=new hc(b,this);rb(a,d)}var d=1,e,c=c[b],b=o in c,f;if(b){e=[];for(f=this;f;f=f.Wd)e.push(f);f=c[o];f.Ca=f.L;for(var g=e.length-1;!a.ec&&0<=g&&f.Ca;g--)a.currentTarget=e[g],d&=xc(f,e[g],a.type,o,a)&&a.hd!=r}if(r in c)if(f=c[r],f.Ca=f.L,b)for(g=0;!a.ec&&g<e.length&&f.Ca;g++)a.currentTarget=e[g],d&=xc(f,e[g],a.type,r,a)&&a.hd!=r;else for(e=this;!a.ec&&e&&
f.Ca;e=e.Wd)a.currentTarget=e,d&=xc(f,e,a.type,r,a)&&a.hd!=r;a=Boolean(d)}else a=o;return a};u.M=function(){Ec.k.M.call(this);uc(this);this.Wd=q};function O(){this.c="base";this.na=window["X.counter"].Qi();this.e=r}H(O,Ec);O.prototype.__defineGetter__("classname",t("c"));O.prototype.__defineGetter__("id",t("na"));E("X.base",O);function Fc(a,b){this.ua=new va(a);this.$=new va(b)}Fc.prototype={f:function(){return new Fc(this.ua.f(),this.$.f())},bc:function(){this.$=this.$.Ve()},Ch:function(a,b){return new Fc(this.ua.bg(a.ua,b),this.$.bg(a.$,b))}};function Gc(a,b){this.$=a;this.nd=b}Gc.prototype={f:function(){return new Gc(this.$.f(),this.nd)},bc:function(){this.$=this.$.Ve();this.nd=-this.nd}};function Hc(a,b){this.hb=a;this.be=b;var c=a[0].ua,d=a[2].ua,d=a[1].ua.cd(c).Ee(d.cd(c)).ld();this.ta=new Gc(d,d.tc(c))}
Hc.prototype={f:function(){var a=this.hb.map(function(a){return a.f()});return new Hc(a,this.be)},bc:function(){this.hb.reverse().map(function(a){a.bc()});this.ta.bc()},vg:function(a,b,c,d,e){for(var f=0,g=[],h=0;h<this.hb.length;h++){var l=a.$.tc(this.hb[h].ua)-a.nd,l=-1.0E-5>l?2:1.0E-5<l?1:0,f=f|l;g.push(l)}switch(f){case 0:(0<a.$.tc(this.ta.$)?b:c).push(this);break;case 1:d.push(this);break;case 2:e.push(this);break;case 3:b=[];c=[];for(h=0;h<this.hb.length;h++){var k=(h+1)%this.hb.length,l=g[h],
j=g[k],f=this.hb[h],k=this.hb[k];2!=l&&b.push(f);1!=l&&c.push(2!=l?f.f():f);3==(l|j)&&(l=(a.nd-a.$.tc(f.ua))/a.$.tc(k.ua.cd(f.ua)),l=f.Ch(k,l),b.push(l),c.push(l.f()))}3<=b.length&&d.push(new Hc(b,this.be));3<=c.length&&e.push(new Hc(c,this.be))}}};function Ic(a){this.fa=this.ga=this.ta=q;this.A=[];a&&this.pc(a)}
Ic.prototype={f:function(){var a=new Ic;a.xi(this.ta&&this.ta.f());a.wi(this.ga&&this.ga.f());a.vi(this.fa&&this.fa.f());a.$d(this.A.map(function(a){return a.f()}));return a},W:function(){for(var a=0;a<this.A.length;a++)this.A[a].bc();this.ta.bc();this.ga&&this.ga.W();this.fa&&this.fa.W();a=this.ga;this.ga=this.fa;this.fa=a},Be:function(a){if(!this.ta)return a.slice();for(var b=[],c=[],d=0;d<a.length;d++)a[d].vg(this.ta,b,c,b,c);this.ga&&(b=this.ga.Be(b));c=this.fa?this.fa.Be(c):[];return b.concat(c)},
Ia:function(a){this.A=a.Be(this.A);this.ga&&this.ga.Ia(a);this.fa&&this.fa.Ia(a)},Cb:function(){var a=this.A.slice();this.ga&&(a=a.concat(this.ga.Cb()));this.fa&&(a=a.concat(this.fa.Cb()));return a},pc:function(a){if(a.length){this.ta||(this.ta=a[0].ta.f());for(var b=[],c=[],d=0;d<a.length;d++)a[d].vg(this.ta,this.A,this.A,b,c);b.length&&(this.ga||(this.ga=new Ic),this.ga.pc(b));c.length&&(this.fa||(this.fa=new Ic),this.fa.pc(c))}},xi:ba("ta"),wi:ba("ga"),vi:ba("fa"),$d:ba("A")};function Jc(){this.A=[]}function Kc(a){var b=new Jc;b.$d(a);return b}
Jc.prototype={f:function(){var a=new Jc;a.$d(this.A.map(function(a){return a.f()}));return a},lf:function(a){var b=new Ic(this.f().A),a=new Ic(a.f().A);b.Ia(a);a.Ia(b);a.W();a.Ia(b);a.W();b.pc(a.Cb());return Kc(b.Cb())},gb:function(a){var b=new Ic(this.f().A),a=new Ic(a.f().A);b.W();b.Ia(a);a.Ia(b);a.W();a.Ia(b);a.W();b.pc(a.Cb());b.W();return Kc(b.Cb())},Oe:function(a){var b=new Ic(this.f().A),a=new Ic(a.f().A);b.W();a.Ia(b);a.W();b.Ia(a);a.Ia(b);b.pc(a.Cb());b.W();return Kc(b.Cb())},inverse:function(){var a=
this.f();a.A.map(function(a){a.bc()});return a},$d:ba("A")};function Lc(){O.call(this);this.c="indexer";this.we=[];this.rb={}}H(Lc,O);Lc.prototype.add=function(a){y(a)||i(Error("Invalid object."));var b=window.JSON.stringify(a);b in this.rb||(this.rb[b]=this.we.length,this.we.push(a));return this.rb[b]};Lc.prototype.unique=t("we");function Mc(a){O.call(this);this.c="file";this.yd=a;this.e=o}H(Mc,O);function Nc(){this.Hb=this.p=q}Nc.prototype.__defineSetter__("file",function(a){this.p=!y(a)||C(a)&&0==a.length?q:C(a)?1==a.length?new Mc(a[0]):vb(a,function(a){var c=new P;c.p=new Mc(a);return c}):new Mc(a)});Nc.prototype.__defineGetter__("file",function(){return!this.p?"":C(this.p)?this.p.map(function(a){return a.p.yd}):this.p.yd});Nc.prototype.__defineGetter__("filedata",t("Hb"));
Nc.prototype.__defineSetter__("filedata",function(a){if(!y(a)||C(a)&&0==a.length)this.Hb=q;if(C(a))if(1==a.length)this.Hb=a[0];else{var b=this.p.length,c;for(c=0;c<b;c++)this.p[c].Hb=a[c]}else this.Hb=a});function Oc(){O.call(this);this.c="colortable";this.rb=new Mb;wa(this,new Nc)}H(Oc,O);Oc.prototype.add=function(a,b,c,d,e,f){(!D(a)||!D(c)||!D(d)||!D(e)||!D(f))&&i(Error("Invalid color table entry."));this.rb.set(a,[b,c,d,e,f]);this.e=o};function Pc(a,b,c){this.x=fa(a)?a:0;this.y=fa(b)?b:0;this.b=fa(c)?c:0}Pc.prototype.f=function(){return new Pc(this.x,this.y,this.b)};Pc.prototype.kf=function(){return[this.x,this.y,this.b]};function Q(a,b,c){this.x=a;this.y=b;this.b=c}H(Q,Pc);u=Q.prototype;u.f=function(){return new Q(this.x,this.y,this.b)};u.dc=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.b*this.b)};u.scale=function(a){this.x*=a;this.y*=a;this.b*=a;return this};u.W=function(){this.x=-this.x;this.y=-this.y;this.b=-this.b;return this};u.normalize=function(){return this.scale(1/this.dc())};u.add=function(a){this.x+=a.x;this.y+=a.y;this.b+=a.b;return this};
u.gb=function(a){this.x-=a.x;this.y-=a.y;this.b-=a.b;return this};u.Vc=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y&&this.b==a.b};function Qc(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.b-b.b;return Math.sqrt(c*c+d*d+e*e)}function Rc(a,b){return new Q(a.x+b.x,a.y+b.y,a.b+b.b)}function Sc(a,b){return new Q(a.y*b.b-a.b*b.y,a.b*b.x-a.x*b.b,a.x*b.y-a.y*b.x)};function Tc(a,b){this.x=fa(a)?a:0;this.y=fa(b)?b:0}Tc.prototype.f=function(){return new Tc(this.x,this.y)};function Uc(a,b){return new Tc(a.x-b.x,a.y-b.y)};function Vc(a,b){this.x=a;this.y=b}H(Vc,Tc);u=Vc.prototype;u.f=function(){return new Vc(this.x,this.y)};u.dc=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};u.scale=function(a){this.x*=a;this.y*=a;return this};u.W=function(){this.x=-this.x;this.y=-this.y;return this};u.normalize=function(){return this.scale(1/this.dc())};u.add=function(a){this.x+=a.x;this.y+=a.y;return this};u.gb=function(a){this.x-=a.x;this.y-=a.y;return this};
u.rotate=function(a){var b=Math.cos(a),a=Math.sin(a),c=this.y*b+this.x*a;this.x=this.x*b-this.y*a;this.y=c;return this};u.Vc=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y};function Wc(a,b){this.width=a;this.height=b}function Xc(a,b){return a==b?o:!a||!b?r:a.width==b.width&&a.height==b.height}u=Wc.prototype;u.f=function(){return new Wc(this.width,this.height)};u.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};u.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};u.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};
u.scale=function(a){this.width*=a;this.height*=a;return this};function Yc(a,b){if(a instanceof Yc)this.R=a.kf();else{var c;if(c=ha(a))a:{for(var d=c=0;d<a.length;d++){if(!ha(a[d])||0<c&&a[d].length!=c){c=r;break a}for(var e=0;e<a[d].length;e++)if(!D(a[d][e])){c=r;break a}0==c&&(c=a[d].length)}c=0!=c}c?this.R=Ab(a):a instanceof Wc?this.R=Zc(a.height,a.width):D(a)&&D(b)&&0<a&&0<b?this.R=Zc(a,b):i(Error("Invalid argument(s) for Matrix contructor"))}this.G=new Wc(this.R[0].length,this.R.length)}
function $c(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new Yc(b)}function ad(a,b,c){for(var d=0;d<a.sa().height;d++)for(var e=0;e<a.sa().width;e++)b.call(c,a.R[d][e],d,e,a)}function bd(a,b){var c=new Yc(a.sa());ad(a,function(d,e,f){c.R[e][f]=b.call(m,d,e,f,a)});return c}function Zc(a,b){for(var c=[],d=0;d<a;d++){c[d]=[];for(var e=0;e<b;e++)c[d][e]=0}return c}u=Yc.prototype;
u.add=function(a){Xc(this.G,a.sa())||i(Error("Matrix summation is only supported on arrays of equal size"));return bd(this,function(b,c,d){return b+a.R[c][d]})};u.Vc=function(a,b){if(this.G.width!=a.G.width||this.G.height!=a.G.height)return r;for(var c=b||0,d=0;d<this.G.height;d++)for(var e=0;e<this.G.width;e++)if(!(Math.abs(this.R[d][e]-a.R[d][e])<=(c||1.0E-6)))return r;return o};u.sa=t("G");u.S=function(a,b){return!(0<=a&&a<this.G.height&&0<=b&&b<this.G.width)?q:this.R[a][b]};
u.j=function(a,b,c){0<=a&&a<this.G.height&&0<=b&&b<this.G.width||i(Error("Index out of bounds when setting matrix value, ("+a+","+b+") in size ("+this.G.height+","+this.G.width+")"));this.R[a][b]=c};u.multiply=function(a){if(a instanceof Yc)return this.G.width!=a.sa().height&&i(Error("Invalid matrices for multiplication. Second matrix should have the same number of rows as the first has columns.")),cd(this,a);if(D(a))return dd(this,a);i(Error("A matrix can only be multiplied by a number or another matrix."))};
u.gb=function(a){Xc(this.G,a.sa())||i(Error("Matrix subtraction is only supported on arrays of equal size."));return bd(this,function(b,c,d){return b-a.R[c][d]})};u.kf=t("R");function cd(a,b){var c=new Yc(a.G.height,b.sa().width);ad(c,function(a,e,f){for(var g=a=0;g<this.G.width;g++)a+=this.S(e,g)*b.S(g,f);c.j(e,f,a)},a);return c}function dd(a,b){return bd(a,function(a){return a*b})};function ed(a,b){Yc.call(this,a,b);this.c="matrix"}H(ed,Yc);function gd(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new ed(b)}u=ed.prototype;u.Ka=function(){var a=[],b=this.sa(),c,d;for(d=0;d<b.height;d++)for(c=0;c<b.width;c++)a.push(this.S(c,d));return a};
u.translate=function(a){this.G.width!=this.G.height&&i(Error("Can not translate non-square matrix."));var b=this.sa(),c=$c(b.height);a instanceof Vc&&3==b.height?(c.j(0,2,a.x),c.j(1,2,a.y)):a instanceof Q&&4==b.height?(c.j(0,3,a.x),c.j(1,3,a.y),c.j(2,3,a.b)):i(Error("Translation failed."));return new ed(this.multiply(c))};
u.rotate=function(a,b){(4!=this.sa().height||this.G.width!=this.G.height)&&i(Error("Only 4x4 matrices can be rotated."));(!y(b)||!(b instanceof Q))&&i(Error("Invalid axis vector."));D(a)||i(Error("Invalid angle."));var c=b.normalize(),d=Math.cos(a),e=Math.sin(a),f=$c(4);f.j(0,0,d+c.x*c.x*(1-d));f.j(0,1,c.x*c.y*(1-d)-c.b*e);f.j(0,2,c.x*c.b*(1-d)+c.y*e);f.j(1,0,c.y*c.x*(1-d)+c.b*e);f.j(1,1,d+c.y*c.y*(1-d));f.j(1,2,c.y*c.b*(1-d)-c.x*e);f.j(2,0,c.b*c.x*(1-d)-c.y*e);f.j(2,1,c.b*c.y*(1-d)+c.x*e);f.j(2,
2,d+c.b*c.b*(1-d));return new ed(this.multiply(f))};u.Na=function(a){var b=this.sa(),c=Array(b.width),d;for(d=0;d<c.length;d++)c[d]=Array(1),c[d][0]=1;a instanceof Q&&3<=b.width?(c[0][0]=a.x,c[1][0]=a.y,c[2][0]=a.b):i(Error("Multiplication by vector failed."));a=this.multiply(new Yc(c));return new Q(parseFloat(a.S(0,0)),parseFloat(a.S(1,0)),parseFloat(a.S(2,0)))};u.Ki=function(a,b){var c=this.R[a];this.R[a]=this.R[b];this.R[b]=c};
u.Ji=function(a,b){for(var c=this.sa(),d=0,d=0;d<c.height;d++){var e=this.S(d,a);e||(e=0);var f=this.S(d,b);f||(f=0);this.j(d,a,f);this.j(d,b,e)}};E("X.matrix",ed);E("X.matrix.createIdentityMatrix",gd);E("X.matrix.prototype.flatten",ed.prototype.Ka);E("X.matrix.prototype.translate",ed.prototype.translate);E("X.matrix.prototype.rotate",ed.prototype.rotate);E("X.matrix.prototype.toArray",ed.prototype.kf);E("X.matrix.prototype.getValueAt",ed.prototype.S);E("X.matrix.prototype.setValueAt",ed.prototype.j);
E("X.matrix.prototype.multiplyByVector",ed.prototype.Na);E("X.matrix.prototype.swapRows",ed.prototype.Ki);E("X.matrix.prototype.swapCols",ed.prototype.Ji);function hd(){O.call(this);this.c="transform";this.C=gd(4);this.tf=new Float32Array(this.C.Ka())}H(hd,O);hd.prototype.__defineGetter__("matrix",t("C"));hd.prototype.__defineSetter__("matrix",function(a){(!y(a)||!(a instanceof ed))&&i(Error("Invalid matrix."));this.C=a;this.o()});u=hd.prototype;u.pi=function(a){(!D(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.C=this.C.rotate(a*Math.PI/180,new Q(0,1,0));this.o()};
u.qi=function(a){(!D(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.C=this.C.rotate(a*Math.PI/180,new Q(1,0,0));this.o()};u.ri=function(a){(!D(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.C=this.C.rotate(a*Math.PI/180,new Q(0,0,1));this.o()};u.Ni=function(a){D(a)||i(Error("Invalid distance."));this.C=this.C.translate(new Q(a,0,0));this.o()};u.Oi=function(a){D(a)||i(Error("Invalid distance."));this.C=this.C.translate(new Q(0,a,0));this.o()};
u.Pi=function(a){D(a)||i(Error("Invalid distance."));this.C=this.C.translate(new Q(0,0,a));this.o()};function id(a,b,c){var d=a.C.S(b,c);d||(d=0);a.C.j(b,c,-1*d);a.o()}u.kh=function(){id(this,0,0)};u.lh=function(){id(this,1,1)};u.mh=function(){id(this,2,2)};u.o=function(){this.tf=new Float32Array(this.C.Ka());this.e=o};E("X.transform",hd);E("X.transform.prototype.rotateX",hd.prototype.pi);E("X.transform.prototype.rotateY",hd.prototype.qi);E("X.transform.prototype.rotateZ",hd.prototype.ri);
E("X.transform.prototype.translateX",hd.prototype.Ni);E("X.transform.prototype.translateY",hd.prototype.Oi);E("X.transform.prototype.translateZ",hd.prototype.Pi);E("X.transform.prototype.flipX",hd.prototype.kh);E("X.transform.prototype.flipY",hd.prototype.lh);E("X.transform.prototype.flipZ",hd.prototype.mh);E("X.transform.prototype.modified",hd.prototype.o);function jd(){O.call(this);this.c="texture";this.qa=this.lb=this.p=q;this.yb=this.zb=0;wa(this,new Nc)}H(jd,O);E("X.texture",jd);function T(a,b){O.call(this);this.c="triplets";this.Pb=Infinity;this.Mb=-Infinity;this.Qb=Infinity;this.Nb=-Infinity;this.Rb=Infinity;this.Ob=-Infinity;this.od=[0,0,0];this.w=0;this.I=new Float32Array(a);y(b)&&(this.I=b.I.subarray(0,b.I.length),this.w=this.I.length,this.Pb=b.Pb,this.Mb=b.Mb,this.Qb=b.Qb,this.Nb=b.Nb,this.Rb=b.Rb,this.Ob=b.Ob,this.od=b.od.slice())}H(T,O);u=T.prototype;
u.add=function(a,b,c){this.Pb=Math.min(this.Pb,a);this.Mb=Math.max(this.Mb,a);this.Qb=Math.min(this.Qb,b);this.Nb=Math.max(this.Nb,b);this.Rb=Math.min(this.Rb,c);this.Ob=Math.max(this.Ob,c);this.od=[(this.Pb+this.Mb)/2,(this.Qb+this.Nb)/2,(this.Rb+this.Ob)/2];this.e=o;this.I[this.w++]=a;this.I[this.w++]=b;this.I[this.w++]=c;return this.w/3};u.zc=function(){if(this.w!=this.I.length){var a=new Float32Array(this.w);a.set(this.I.subarray(0,this.w));this.I=a}};
u.get=function(a){a*=3;return[this.I[a],this.I[a+1],this.I[a+2]]};u.remove=function(){i(Error("Not implemented."))};u.clear=function(){this.I=new Float32Array(this.I.length);this.e=o};T.prototype.__defineGetter__("count",function(){this.zc();return this.I.length/3});T.prototype.__defineGetter__("length",function(){this.zc();return this.I.length});E("X.triplets",T);E("X.triplets.prototype.add",T.prototype.add);E("X.triplets.prototype.resize",T.prototype.zc);E("X.triplets.prototype.get",T.prototype.get);
E("X.triplets.prototype.remove",T.prototype.remove);E("X.triplets.prototype.clear",T.prototype.clear);function nd(){this.ia=od;this.Xb=new hd;this.Fb=[1,1,1];this.Wb=this.z=this.T=this.h=this.g=q;this.oc=[];this.Ga=o;this.nc=this.Nc=1;this.ic=q;this.Gc=r;this.V=1;this.O=0}var od="TRIANGLES";nd.prototype.__defineSetter__("type",function(a){return this.ia=a});nd.prototype.__defineGetter__("type",t("ia"));nd.prototype.__defineGetter__("texture",function(){this.z||(this.z=new jd);return this.z});nd.prototype.__defineGetter__("transform",t("Xb"));nd.prototype.__defineGetter__("points",t("g"));
nd.prototype.__defineSetter__("points",ba("g"));nd.prototype.__defineGetter__("normals",t("h"));nd.prototype.__defineSetter__("normals",ba("h"));nd.prototype.__defineGetter__("colors",t("T"));nd.prototype.__defineSetter__("colors",ba("T"));nd.prototype.__defineGetter__("color",t("Fb"));nd.prototype.__defineSetter__("color",function(a){(!y(a)||!C(a)||3!=a.length)&&i(Error("Invalid color."));for(var b=this.d,c=b.length,d=0,d=0;d<c;d++)b[d].color=a;this.Fb=a;this.e=o});
nd.prototype.__defineGetter__("opacity",t("V"));nd.prototype.__defineSetter__("opacity",function(a){(!D(a)||1<a||0>a)&&i(Error("Invalid opacity."));for(var b=this.d,c=b.length,d=0,d=0;d<c;d++)b[d].opacity=a;this.V=a;this.e=o});nd.prototype.__defineGetter__("caption",t("ic"));nd.prototype.__defineSetter__("caption",function(a){this.ic=a;this.e=o});nd.prototype.__defineGetter__("visible",t("Ga"));
nd.prototype.__defineSetter__("visible",function(a){for(var b=this.d,c=b.length,d=0,d=0;d<c;d++)b[d].visible=a;this.Ga=a;this.e=o});nd.prototype.__defineGetter__("pointsize",t("Nc"));nd.prototype.__defineSetter__("pointsize",function(a){D(a)||i(Error("Invalid point size."));this.Nc=a;this.e=o});nd.prototype.__defineGetter__("magicmode",t("Gc"));nd.prototype.__defineSetter__("magicmode",function(a){"boolean"!=typeof a&&i(Error("Invalid magic mode setting."));this.Gc=a;this.e=o});
nd.prototype.__defineGetter__("linewidth",t("nc"));nd.prototype.__defineSetter__("linewidth",function(a){D(a)||i(Error("Invalid line width."));this.nc=a;this.e=o});function pd(){this.Fa=Infinity;this.ba=this.Aa=-Infinity;this.ca=Infinity;this.ub=[0,0,0];this.sb=[1,1,1]}pd.prototype.__defineGetter__("lowerThreshold",t("ba"));pd.prototype.__defineSetter__("lowerThreshold",ba("ba"));pd.prototype.__defineGetter__("upperThreshold",t("ca"));pd.prototype.__defineSetter__("upperThreshold",ba("ca"));pd.prototype.__defineGetter__("min",t("Fa"));pd.prototype.__defineGetter__("max",t("Aa"));pd.prototype.__defineGetter__("minColor",t("ub"));
pd.prototype.__defineSetter__("minColor",function(a){(!y(a)||!C(a)||3!=a.length)&&i(Error("Invalid min. color."));this.ub=a});pd.prototype.__defineGetter__("maxColor",t("sb"));pd.prototype.__defineSetter__("maxColor",function(a){(!y(a)||!C(a)||3!=a.length)&&i(Error("Invalid max. color."));this.sb=a});function qd(){O.call(this);this.c="scalars";this.Cc=this.t=q;this.Cf=o;this.ge=0;wa(this,new Nc);wa(this,new pd);this.ub=[0,1,0];this.sb=[1,0,0]}H(qd,O);qd.prototype.__defineGetter__("array",t("t"));qd.prototype.__defineSetter__("array",function(a){this.Cc=this.t=a;this.e=o});qd.prototype.__defineGetter__("interpolation",t("ge"));qd.prototype.__defineSetter__("interpolation",ba("ge"));E("X.scalars",qd);function V(a){O.call(this);this.c="object";this.d=[];this.r=this.X=q;wa(this,new nd);y(a)&&this.$b(a)}H(V,O);
V.prototype.$b=function(a){this.ia=a.ia;this.Xb=new hd;this.Xb.C=new ed(a.Xb.C.R);this.Fb=a.Fb.slice();a.g&&(this.g=new T(a.g.length,a.g));a.h&&(this.h=new T(a.h.length,a.h));a.T&&(this.T=new T(a.T.length,a.T));this.z=a.z;this.Wb=a.Wb;a.p&&(this.p=new Mc((new String(a.p.yd)).toString()));this.V=a.V;this.d.length=0;var b=a.d;if(b)for(var c=b.length,d=0,d=0;d<c;d++)this.d.push(new I[b[d].c](b[d]));this.Ga=a.Ga;this.Nc=a.Nc;this.nc=a.nc;a.ic&&(this.ic=(new String(a.ic)).toString());this.Gc=a.Gc;this.oc=
a.oc.slice();this.e=o};V.prototype.__defineGetter__("colortable",function(){this.X||(this.X=new Oc);return this.X});V.prototype.__defineGetter__("scalars",function(){this.r||(this.r=new qd);return this.r});V.prototype.__defineGetter__("children",t("d"));V.prototype.o=function(){var a=new rd;a.Z=this;this.dispatchEvent(a)};
function sd(a,b){(!y(a)||!y(b)||!(a instanceof V)||!(b instanceof V))&&i(Error("Fatal: Two valid X.objects are required for comparison."));return 1==a.V?-1:1==b.V?1:y(a.O)&&y(b.O)&&a.O>b.O?-1:1}E("X.object",V);E("X.object.prototype.modified",V.prototype.o);function td(){}function ud(a){for(var b=a.g.count,c=[],d=0,d=0;d<b;d+=3){var e=a.g.get(d),f=a.g.get(d+1),g=a.g.get(d+2),h=a.h.get(d),l=a.h.get(d+1),k=a.h.get(d+2),j=a.Fb;a.T&&0<a.T.length&&(j=a.T.get(d));var n=[];n.push(new Fc(e,h));n.push(new Fc(f,l));n.push(new Fc(g,k));c.push(new Hc(n,j))}return Kc(c)}
function vd(a,b){(!y(b)||!(b instanceof Jc))&&i(Error("Invalid CSG object."));var c=new Lc,d=[];vb(b.A,function(a){for(var b=[],g=a.be,b=vb(a.hb,function(a){a.color=g;return c.add(a)}),a=a=2;a<b.length;a++)d.push([b[0],b[a-1],b[a]])}.bind(a));a.Mg=vb(c.unique(),function(a){return[a.ua.x(),a.ua.y(),a.ua.b()]});a.Lg=vb(c.unique(),function(a){return[a.$.x(),a.$.y(),a.$.b()]});a.Kg=vb(c.unique(),function(a){return!a.color?q:[a.color[0],a.color[1],a.color[2]]});a.g=new T(9*d.length);a.h=new T(9*d.length);
a.T=new T(9*d.length);vb(d,function(a){var b=a[0],c=a[1],a=a[2],d=this.Mg,l=this.Lg,k=this.Kg;this.g.add(d[b][0],d[b][1],d[b][2]);this.g.add(d[c][0],d[c][1],d[c][2]);this.g.add(d[a][0],d[a][1],d[a][2]);this.h.add(l[b][0],l[b][1],l[b][2]);this.h.add(l[c][0],l[c][1],l[c][2]);this.h.add(l[a][0],l[a][1],l[a][2]);k[b]&&this.T.add(k[b][0],k[b][1],k[b][2]);k[c]&&this.T.add(k[c][0],k[c][1],k[c][2]);k[a]&&this.T.add(k[a][0],k[a][1],k[a][2])}.bind(a));0==a.T.w&&(a.T=q);a.ia=od}
td.prototype.lf=function(a){(!y(a)||!(a instanceof Jc)&&!(a instanceof V))&&i(Error("Invalid object."));var b=a;a instanceof V&&(b=ud(b));a=new V;wa(a,new td);vd(a,ud(this).lf(b));return a};td.prototype.gb=function(a){(!y(a)||!(a instanceof Jc)&&!(a instanceof V))&&i(Error("Invalid object."));var b=a;a instanceof V&&(b=ud(b));a=new V;wa(a,new td);vd(a,ud(this).gb(b));return a};
td.prototype.Oe=function(a){(!y(a)||!(a instanceof Jc)&&!(a instanceof V))&&i(Error("Invalid object."));var b=a;a instanceof V&&(b=ud(b));a=new V;wa(a,new td);vd(a,ud(this).Oe(b));return a};td.prototype.inverse=function(){var a=new V;wa(a,new td);vd(a,ud(this).inverse());return a};E("X.constructable",td);E("X.constructable.prototype.intersect",td.prototype.Oe);E("X.constructable.prototype.inverse",td.prototype.inverse);E("X.constructable.prototype.subtract",td.prototype.gb);
E("X.constructable.prototype.union",td.prototype.lf);function wd(a){hc.call(this,a);this.c="event"}H(wd,hc);var xd=Dc("pan"),yd=Dc("rotate"),zd=Dc("zoom"),Ad=Dc("scroll");Dc("render");var Bd=Dc("resetview"),Cd=Dc("windowlevel"),wc=Dc("modified"),Dd=Dc("progress"),Ed=Dc("hover"),Fd=Dc("hover_end"),Gd=Dc("paint");function Id(){wd.call(this,xd);this.O=new Vc(0,0)}H(Id,wd);function Jd(){wd.call(this,yd);this.O=new Vc(0,0)}H(Jd,wd);function Kd(){wd.call(this,zd);this.jb=this.Kb=r}H(Kd,wd);function Ld(){wd.call(this,Ad);this.J=r}H(Ld,wd);
function Md(){wd.call(this,Ed);this.Zb=this.Yb=0}H(Md,wd);function Nd(){wd.call(this,Fd)}H(Nd,wd);function Od(){wd.call(this,Gd);this.Zb=this.Yb=0}H(Od,wd);function Pd(){wd.call(this,Bd)}H(Pd,wd);function rd(){wd.call(this,wc);this.s=this.Z=q}H(rd,wd);function Qd(){wd.call(this,Dd);this.Df=0}H(Qd,wd);function Rd(a,b,c){y(a)||i(Error("Invalid GL Buffer."));y(b)||i(Error("Invalid number of items."));y(c)||i(Error("Invalid item size."));O.call(this);this.c="buffer";this.ha=a;this.pb=b;this.qb=c}H(Rd,O);function Sd(a){this.q=a;this.cg=M(this.q,Ta?"DOMMouseScroll":"mousewheel",this)}H(Sd,Ec);
Sd.prototype.handleEvent=function(a){var b=0,c=0,d=0,a=a.Ta;if("mousewheel"==a.type){c=1;if(L||Ua&&(Ma||hb("532.0")))c=40;d=Ua&&La&&0!=-a.wheelDelta%c?-a.wheelDelta:-a.wheelDelta/c;fa(a.wheelDeltaX)?(b=Ua&&La&&0!=-a.wheelDeltaX%c?-a.wheelDeltaX:-a.wheelDeltaX/c,c=Ua&&La&&0!=-a.wheelDeltaY%c?-a.wheelDeltaY:-a.wheelDeltaY/c):c=d}else d=a.detail,100<d?d=3:-100>d&&(d=-3),fa(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=d:c=d;D(this.eg)&&Math.min(Math.max(b,-this.eg),this.eg);D(this.fg)&&(c=Math.min(Math.max(c,
-this.fg),this.fg));b=new Td(d,a,0,c);try{this.dispatchEvent(b)}finally{b.Ja()}};Sd.prototype.M=function(){Sd.k.M.call(this);sc(this.cg);delete this.cg};function Td(a,b,c,d){b&&this.ja(b,m);this.type="mousewheel";this.detail=a;this.sc=d}H(Td,jc);L||Ua&&hb("525");var Ud;function Vd(a,b){var c;c=(c=a.className)&&"function"==typeof c.split?c.split(/\s+/):[];var d=Bb(arguments,1),e;e=c;for(var f=0,g=0;g<d.length;g++)0<=tb(e,d[g])||(e.push(d[g]),f++);e=f==d.length;a.className=c.join(" ");return e};var Wd=!L||kb(9);!Ta&&!L||L&&kb(9)||Ta&&hb("1.9.1");L&&hb("9");function Xd(a){return a?new Zd($d(a)):Ud||(Ud=new Zd)}function ae(a){return ia(a)?document.getElementById(a):a}function be(a,b){lb(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in ce?a.setAttribute(ce[d],b):0==d.lastIndexOf("aria-",0)?a.setAttribute(d,b):a[d]=b})}
var ce={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder",maxlength:"maxLength",type:"type"};function de(a,b,c){return ee(document,arguments)}
function ee(a,b){var c=b[0],d=b[1];if(!Wd&&d&&(d.name||d.type)){c=["<",c];d.name&&c.push(' name="',xa(d.name),'"');if(d.type){c.push(' type="',xa(d.type),'"');var e={};rb(e,d);d=e;delete d.type}c.push(">");c=c.join("")}c=a.createElement(c);d&&(ia(d)?c.className=d:C(d)?Vd.apply(q,[c].concat(d)):be(c,d));2<b.length&&fe(a,c,b);return c}
function fe(a,b,c){function d(c){c&&b.appendChild(ia(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];ha(f)&&!(ka(f)&&0<f.nodeType)?ub(ge(f)?Ab(f):f,d):d(f)}}function he(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function ie(a){for(;a&&1!=a.nodeType;)a=a.nextSibling;return a}
function je(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}function $d(a){return 9==a.nodeType?a:a.ownerDocument||a.document}function ge(a){if(a&&"number"==typeof a.length){if(ka(a))return"function"==typeof a.item||"string"==typeof a.item;if(ja(a))return"function"==typeof a.item}return r}function Zd(a){this.N=a||ca.document||document}u=Zd.prototype;
u.Md=Xd;u.i=function(a){return ia(a)?this.N.getElementById(a):a};u.qc=function(a,b,c){return ee(this.N,arguments)};u.createElement=function(a){return this.N.createElement(a)};u.createTextNode=function(a){return this.N.createTextNode(a)};function ke(a){return"CSS1Compat"==a.N.compatMode}function le(a){var b=a.N,a=!Ua&&"CSS1Compat"==b.compatMode?b.documentElement:b.body,b=b.parentWindow||b.defaultView;return new Tc(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}u.appendChild=function(a,b){a.appendChild(b)};
u.contains=je;function me(a){(!y(a)||!(a instanceof Element))&&i(Error("Could not add interactor to the given element."));O.call(this);this.c="interactor";this.jc=a;this.ne=this.xf=this.wf=this.yf=this.vf=this.zf=q;this.me=o;this.Ab=this.tb=this.Ya=r;this.vd=[0,0];this.ie=new Vc(0,0);this.U={MOUSEWHEEL_ENABLED:o,MOUSECLICKS_ENABLED:o,KEYBOARD_ENABLED:o,HOVERING_ENABLED:o,CONTEXTMENU_ENABLED:r}}H(me,O);me.prototype.__defineGetter__("config",t("U"));me.prototype.__defineGetter__("leftButtonDown",t("Ya"));
me.prototype.__defineGetter__("middleButtonDown",t("tb"));me.prototype.__defineGetter__("rightButtonDown",t("Ab"));
me.prototype.ja=function(){this.U.MOUSEWHEEL_ENABLED?(this.ne=new Sd(this.jc),this.zf=M(this.ne,"mousewheel",this.dd.bind(this))):(sc(this.zf),this.ne=q);this.U.MOUSECLICKS_ENABLED?(this.vf=M(this.jc,"mousedown",this.Oh.bind(this)),this.yf=M(this.jc,"mouseup",this.Th.bind(this))):(sc(this.vf),sc(this.yf));this.jc.oncontextmenu=this.U.CONTEXTMENU_ENABLED?q:function(){return r};window.onkeydown=this.U.KEYBOARD_ENABLED?this.kg.bind(this):q;sc(this.wf);sc(this.xf);this.wf=M(this.jc,"mousemove",this.Qh.bind(this));
this.xf=M(this.jc,"mouseout",this.Rh.bind(this))};me.prototype.Oh=function(a){0==a.button?this.Ya=o:1==a.button?this.tb=o:2==a.button&&(this.Ab=o);eval("this.onMouseDown("+this.Ya+","+this.tb+","+this.Ab+")");oe(this);a.preventDefault()};me.prototype.Nh=aa();
me.prototype.Th=function(a){0==a.button?this.Ya=r:1==a.button?this.tb=r:2==a.button&&(this.Ab=r);if(this instanceof pe){var b=new Od;b.Yb=a.offsetX;b.Zb=a.offsetY;this.dispatchEvent(b)}eval("this.onMouseUp("+this.Ya+","+this.tb+","+this.Ab+")");oe(this);a.preventDefault()};me.prototype.__defineGetter__("mousePosition",t("vd"));u=me.prototype;u.Sh=aa();u.Rh=function(a){this.me=r;this.U.KEYBOARD_ENABLED&&(window.onkeydown=q);this.Ab=this.tb=this.Ya=r;oe(this);this.ie=new Vc(0,0);a.preventDefault()};
u.Ph=aa();
u.Qh=function(a){this.mousemoveEvent=a;eval("this.onMouseMove(this['mousemoveEvent'])");this.me=o;this.U.KEYBOARD_ENABLED&&window.onkeydown==q&&(window.onkeydown=this.kg.bind(this));a.preventDefault();var b=a.shiftKey;this.vd=[a.offsetX,a.offsetY];var c=new Vc(this.vd[0],this.vd[1]),a=this.ie.gb(c);this.ie=c.f();this.U.HOVERING_ENABLED&&((0<Math.abs(a.x)||0<Math.abs(a.y)||this.tb||this.Ya||this.Ab)&&oe(this),this.Le=setTimeout(function(){oe(this);var a=new Md;a.Yb=c.x;a.Zb=c.y;this.dispatchEvent(a);this.Le=
q}.bind(this),300));2>Math.abs(a.x)&&(a.x=0);2>Math.abs(a.y)&&(a.y=0);0!=a.dc()&&(this.Ya&&!b?(b=new Jd,b.O=a,this.dispatchEvent(b)):this.tb||this.Ya&&b?(b=new Id,5<a.x?a.x=5:-5>a.x&&(a.x=-5),5<a.y?a.y=5:-5>a.y&&(a.y=-5),b.O=a,this.dispatchEvent(b)):this.Ab&&(b=new Kd,b.Kb=0<a.y,b.jb=r,this.dispatchEvent(b)))};function oe(a){a.Le&&clearTimeout(a.Le);a.dispatchEvent(new Nd)}u.Uh=aa();u.dd=function(a){this.mouseWheelEvent=a;eval("this.onMouseWheel(this['mouseWheelEvent'])");oe(this);a.preventDefault()};
u.Lh=aa();u.rotate=function(a,b){var c=new Jd;c.O=[a,b];this.dispatchEvent(c)};
u.kg=function(a){if(this.me){this.keyEvent=a;eval("this.onKey(this['keyEvent'])");oe(this);var b=a.altKey,c=a.ctrlKey,d=a.metaKey,e=a.shiftKey,f=a.keyCode;82==f&&!b&&!c&&!d&&!e?(a.preventDefault(),a=new Pd,this.dispatchEvent(a)):37<=f&&40>=f&&(a.preventDefault(),e?a=new Id:b?a=new Kd:(a=new Jd,this instanceof pe&&(a=new Ld)),a&&(c=new Vc(0,0),37==f?(c.x=5,a.J=r,b&&(a.J=o,a.Kb=o,a.jb=r)):39==f?(c.x=-5,a.J=o,b&&(a.Kb=r,a.jb=r)):38==f?(c.y=5,a.J=o,b&&(a.Kb=o,a.jb=o)):40==f&&(c.y=-5,a.J=r,b&&(a.Kb=r,
a.jb=o)),a.O=c,this.dispatchEvent(a)))}};E("X.interactor",me);E("X.interactor.prototype.init",me.prototype.ja);E("X.interactor.prototype.onMouseDown",me.prototype.Nh);E("X.interactor.prototype.onMouseUp",me.prototype.Sh);E("X.interactor.prototype.onMouseMove",me.prototype.Ph);E("X.interactor.prototype.onMouseWheel",me.prototype.Uh);E("X.interactor.prototype.onKey",me.prototype.Lh);E("X.interactor.prototype.rotate",me.prototype.rotate);function pe(a){me.call(this,a);this.c="interactor2D"}H(pe,me);pe.prototype.dd=function(a){pe.k.dd.call(this,a);var b=new Ld;y(a.sc)||(a.sc=0);b.J=0>a.sc;this.dispatchEvent(b)};function qe(a,b){(!D(a)||!D(b))&&i(Error("A camera needs valid width and height values."));O.call(this);this.c="camera";this.pa=new Q(0,0,100);this.kc=new Q(0,0,0);this.J=new Q(0,1,0);this.m=this.Vd(this.pa,this.kc);this.Jb=new Float32Array(this.m.Ka())}H(qe,O);qe.prototype.Zh=function(a){a instanceof Jd||i(Error("Received no valid rotate event."));this.rotate(a.O)};qe.prototype.ci=function(a){a instanceof Kd||i(Error("Received no valid zoom event."));a.Kb?this.Eg(a.jb):this.Fg(a.jb)};
qe.prototype.Wh=function(a){a instanceof Id||i(Error("Received no valid pan event."));this.pg(a.O)};qe.prototype.__defineGetter__("view",t("m"));qe.prototype.__defineSetter__("view",function(a){(!y(a)||!(a instanceof ed))&&i(Error("Invalid view matrix."));this.m=a;this.Jb=new Float32Array(this.m.Ka())});qe.prototype.__defineGetter__("position",function(){return[this.pa.x,this.pa.y,this.pa.b]});
qe.prototype.__defineSetter__("position",function(a){(!y(a)||!C(a)||3!=a.length)&&i(Error("Invalid position."));this.pa=new Q(a[0],a[1],a[2]);this.reset()});qe.prototype.__defineGetter__("focus",function(){return[this.kc.x,this.kc.y,this.kc.b]});qe.prototype.__defineSetter__("focus",function(a){(!y(a)||!C(a)||3!=a.length)&&i(Error("Invalid focus"));this.kc=new Q(a[0],a[1],a[2]);this.reset()});qe.prototype.__defineGetter__("up",function(){return[this.J.x,this.J.y,this.J.b]});
qe.prototype.__defineSetter__("up",function(a){(!y(a)||!C(a)||3!=a.length)&&i(Error("Invalid up vector."));this.J=new Q(a[0],a[1],a[2]);this.reset()});u=qe.prototype;u.reset=function(){this.m=this.Vd(this.pa,this.kc);this.Jb=new Float32Array(this.m.Ka())};u.rotate=function(a){C(a)&&2==a.length?a=new Vc(a[0],a[1]):a instanceof Vc||i(Error("Invalid distance vector for rotate operation."));return a};
u.pg=function(a){C(a)&&2==a.length?a=new Vc(a[0],a[1]):a instanceof Vc||i(Error("Invalid distance vector for pan operation."));a=new Q(-a.x,a.y,0);a=gd(4).translate(a);this.m=new ed(a.multiply(this.m));this.Jb=new Float32Array(this.m.Ka())};u.Eg=function(a){var b=20;y(a)&&!a&&(b=1);a=new Q(0,0,b);a=gd(4).translate(a);this.m=new ed(a.multiply(this.m));this.Jb=new Float32Array(this.m.Ka())};
u.Fg=function(a){var b=30;y(a)&&!a&&(b=1);a=new Q(0,0,-b);a=gd(4).translate(a);this.m=new ed(a.multiply(this.m));this.Jb=new Float32Array(this.m.Ka())};u.Vd=function(a,b){(!(a instanceof Q)||!(b instanceof Q))&&i(Error("3D vectors required for calculating the view."));return gd(4)};E("X.camera",qe);E("X.camera.prototype.pan",qe.prototype.pg);E("X.camera.prototype.rotate",qe.prototype.rotate);E("X.camera.prototype.zoomIn",qe.prototype.Eg);E("X.camera.prototype.zoomOut",qe.prototype.Fg);function re(a,b){qe.call(this,a,b);this.c="camera3D";this.Og=45;var c=Float32Array,d;d=a/b;var e=1*Math.tan(this.Og*Math.PI/360),f=-e;d=new ed([[2/(e*d-f*d),0,(e*d+f*d)/(e*d-f*d),0],[0,2/(e-f),(e+f)/(e-f),0],[0,0,-10001/9999,-2.000200020002],[0,0,-1,0]]);this.Rg=new c(d.Ka())}H(re,qe);
re.prototype.rotate=function(a){var a=re.k.rotate.call(this,a),b=-a.x/5*Math.PI/180,a=-a.y/5*Math.PI/180,c=gd(4),d=new Q(parseFloat(this.m.S(0,0)),parseFloat(this.m.S(0,1)),parseFloat(this.m.S(0,2))),b=c.rotate(b,new Q(parseFloat(this.m.S(1,0)),parseFloat(this.m.S(1,1)),parseFloat(this.m.S(1,2)))),a=c.rotate(a,d);this.m=new ed(this.m.multiply(a.multiply(b)));this.Jb=new Float32Array(this.m.Ka())};
re.prototype.Vd=function(a,b){re.k.Vd.call(this,a,b);var c=gd(4),d=new Q(a.x-b.x,a.y-b.y,a.b-b.b),d=d.normalize(),e=this.J.f();e.Vc(d)&&(e.b+=1.0E-6);var f=Sc(e,d),e=Sc(d,f),f=f.normalize(),e=e.normalize();c.j(0,0,f.x);c.j(0,1,f.y);c.j(0,2,f.b);c.j(0,3,0);c.j(1,0,e.x);c.j(1,1,e.y);c.j(1,2,e.b);c.j(1,3,0);c.j(2,0,d.x);c.j(2,1,d.y);c.j(2,2,d.b);c.j(2,3,0);c.j(3,0,0);c.j(3,1,0);c.j(3,2,0);c.j(3,3,1);d=a.f();return c.translate(d.W())};E("X.camera3D",re);function Z(){O.call(this);this.c="parser";this.aa=q;this.w=0;this.Qg=0<(new Int8Array((new Int16Array([1])).buffer))[0];this.sd=o}H(Z,O);Z.prototype.parse=function(){i(Error("The function parse() should be overloaded."))};function se(a){for(var b=Infinity,c=-Infinity,d=a.length,e=0,e=0;e<d;e++)var f=a[e],b=Math.min(b,f),c=Math.max(c,f);return[b,c]}
function $(a,b,c){y(c)||(c=1);var d=1,e=Uint8Array;switch(b){case "schar":e=Int8Array;break;case "ushort":e=Uint16Array;d=2;break;case "sshort":e=Int16Array;d=2;break;case "uint":e=Uint32Array;d=4;break;case "sint":e=Int32Array;d=4;break;case "float":e=Float32Array,d=4}b=new e(a.aa.slice(a.w,a.w+=c*d));if(a.Qg!=a.sd){a=b;b=new Uint8Array(a.buffer,a.byteOffset,a.byteLength);for(e=0;e<a.byteLength;e+=d)for(var f=e+d-1,g=e;f>g;f--,g++){var h=b[g];b[g]=b[f];b[f]=h}b=a}return 1==c?b[0]:b}
function te(a,b,c){I.Ea(a.c+".reslice");var d=b.Y,e=c.max,f=c.data,g=d[2],h=d[1],d=d[0],l=b.n!=q,k=h*d,j=Array(g),n=Array(g),s=0,p=q;b.X&&(p=b.X.rb);for(var w=0,v=0,z=0,B=0,x=4*k,w=0;w<g;w++){j[w]=Array(h);n[w]=Array(h);for(var A=f.subarray(w*k,(w+1)*k),F=new Uint8Array(x),v=B=0;v<h;v++){j[w][v]=new c.data.constructor(d);n[w][v]=new c.data.constructor(d);for(z=0;z<d;z++){var s=A[B],N=0,W=0,G=0,K=0;p?(K=p.get(Math.floor(s)),K||(N=p.La(),K=N[N.length-1]),N=255*K[1],W=255*K[2],G=255*K[3],K=255*K[4]):
(N=W=G=255*(s/e),K=255);var J=4*B;F[J]=N;F[++J]=W;F[++J]=G;F[++J]=K;j[w][v][z]=255*(s/e);n[w][v][z]=s;B++}}s=new jd;s.qa=F;s.zb=d;s.yb=h;A=b.$a.d[w];A.z=s;l&&(A.n=b.n.$a.d[w].z)}d!=h?l?b.X?(ue(g,d,h,n,b.X,b.Q,b.n.Q,o),ue(g,h,d,n,b.X,b.P,b.n.P,r)):(ve(g,d,h,j,b.Q,b.n.Q,o),ve(g,h,d,j,b.P,b.n.P,r)):b.X?(ue(g,d,h,n,b.X,b.Q,q,o),ue(g,h,d,n,b.X,b.P,q,r)):(ve(g,d,h,j,b.Q,q,o),ve(g,h,d,j,b.P,q,r)):l?b.X?we(g,d,h,j,b.X,b.P,b.n.P,b.Q,b.n.Q):xe(g,d,h,j,b.P,b.n.P,b.Q,b.n.Q):b.X?we(g,d,h,n,b.X,b.P,q,b.Q,q):xe(g,
d,h,j,b.P,q,b.Q,q);I.ya(a.c+".reslice");return n}function ve(a,b,c,d,e,f,g){for(var h=4*a*b,l=0,l=0;l<c;l++){for(var k=new Uint8Array(h),j=0,n=0,j=0;j<a;j++)for(var s=0,p=d[j],s=0;s<b;s++){var w,v=w=g?p[l][s]:p[s][l],z=w,B=4*n;k[B]=w;k[++B]=v;k[++B]=z;k[++B]=255;n++}j=new jd;j.qa=k;j.zb=b;j.yb=a;k=e.d[l];k.z=j;f&&(k.n=f.d[l].z)}}
function ue(a,b,c,d,e,f,g,h){for(var e=e.rb,l=4*a*b,k=0,k=0;k<c;k++){for(var j=new Uint8Array(l),n=0,s=0,n=0;n<a;n++)for(var p=d[n],w=0,w=0;w<b;w++){var v=e.get(Math.floor(h?p[k][w]:p[w][k]));v||(v=e.La(),v=v[v.length-1]);var z=255*v[2],B=255*v[3],x=255*v[4],A=4*s;j[A]=255*v[1];j[++A]=z;j[++A]=B;j[++A]=x;s++}n=new jd;n.qa=j;n.zb=b;n.yb=a;j=f.d[k];j.z=n;g&&(j.n=g.d[k].z)}}
function xe(a,b,c,d,e,f,g,h){for(var l=4*a*b,k=0,k=0;k<c;k++){for(var j=new Uint8Array(l),n=new Uint8Array(l),s=0,p=0,p=0;p<a;p++)for(var w=d[p],v=0,v=0;v<b;v++){var z=w[v][k],B=z,x=z,A=4*s;j[A]=z;j[++A]=B;j[++A]=x;j[++A]=255;x=B=z=A=w[k][v];A=4*s;n[A]=z;n[++A]=B;n[++A]=x;n[++A]=255;s++}s=new jd;s.qa=j;s.zb=b;s.yb=a;j=e.d[k];j.z=s;f&&(j.n=f.d[k].z);j=new jd;j.qa=n;j.zb=b;j.yb=a;n=g.d[k];n.z=j;h&&(n.n=h.d[k].z)}}
function we(a,b,c,d,e,f,g,h,l){for(var e=e.rb,k=4*a*b,j=0,j=0;j<c;j++){for(var n=new Uint8Array(k),s=new Uint8Array(k),p=0,w=0,w=0;w<a;w++)for(var v=d[w],z=0,z=0;z<b;z++){var B=e.get(Math.floor(v[z][j]));if(!B)var x=e.La(),B=x[x.length-1];var A=255*B[2],F=255*B[3],N=255*B[4],x=4*p;n[x]=255*B[1];n[++x]=A;n[++x]=F;n[++x]=N;x=e.get(Math.floor(v[j][z]));x||(x=e.La(),x=x[x.length-1]);B=255*x[1];A=255*x[2];F=255*x[3];N=255*x[4];x=4*p;s[x]=B;s[++x]=A;s[++x]=F;s[++x]=N;p++}p=new jd;p.qa=n;p.zb=b;p.yb=a;n=
f.d[j];n.z=p;g&&(n.n=g.d[j].z);n=new jd;n.qa=s;n.zb=b;n.yb=a;s=h.d[j];s.z=n;l&&(s.n=l.d[j].z)}};function ye(){Z.call(this);this.c="parserIMAGE"}H(ye,Z);ye.prototype.parse=function(a,b,c,d){c instanceof ArrayBuffer||i(Error());for(var e=new Uint8Array(c),f=e.length,g=Array(f);f--;)g[f]=String.fromCharCode(e[f]);e=window.btoa(g.join(""));f=new Image;qc(f,"load",this.di.bind(this,f,a,b,c,d));f.src="data:image/"+d+";base64,"+e};ye.prototype.di=function(a,b,c){b.lb=a;b.qa=q;a=new rd;a.Z=c;a.s=b;this.dispatchEvent(a)};E("X.parserIMAGE",ye);E("X.parserIMAGE.prototype.parse",ye.prototype.parse);function ze(a,b){qe.call(this,a,b);this.c="camera2D"}H(ze,qe);function Ae(){O.call(this);this.c="shaders";this.Dd="";this.Dd="precision mediump float;\n\nattribute vec3 vertexPosition;\nattribute vec3 vertexNormal;\nattribute vec3 vertexColor;\nattribute vec2 vertexTexturePos;\nattribute float vertexScalar;\n\nuniform mat4 view;\nuniform mat4 perspective;\nuniform vec3 center;\nuniform mat4 objectTransform;\nuniform bool useObjectColor;\nuniform bool useScalars;\nuniform bool scalarsReplaceMode;\nuniform float scalarsMin;\nuniform float scalarsMax;\nuniform vec3 scalarsMinColor;\nuniform vec3 scalarsMaxColor;\nuniform float scalarsMinThreshold;\nuniform float scalarsMaxThreshold;\nuniform int scalarsInterpolation;\nuniform vec3 objectColor;\nuniform float pointSize;\n\nvarying float fDiscardNow;\nvarying vec4 fVertexPosition;\nvarying vec3 fragmentColor;\nvarying vec2 fragmentTexturePos;\nvarying vec3 fVertexNormal;\nvarying vec3 fTransformedVertexNormal;\n\nvoid main(void) {\n  fTransformedVertexNormal = mat3(view[0].xyz,view[1].xyz,view[2].xyz) * mat3(objectTransform[0].xyz,objectTransform[1].xyz,objectTransform[2].xyz) * vertexNormal;\n  fVertexNormal = vertexNormal;\n  fDiscardNow = 0.0;\n  vec3 vertexPosition2 = vertexPosition - center;\n  fVertexPosition = view * objectTransform * vec4(vertexPosition2, 1.0);\n  fragmentTexturePos = vertexTexturePos;\n  if (useScalars) {\n    float scalarValue = vertexScalar;\n    if (scalarValue < scalarsMinThreshold || scalarValue > scalarsMaxThreshold) {\n      if (scalarsReplaceMode) {\n        fragmentColor = objectColor;\n      } else {\n        fDiscardNow = 1.0;\n      }\n    } else {\n      if (scalarsReplaceMode) {\n        if (scalarsInterpolation == 1) {\n            vec3 zeroMaxColor;\n            vec3 zeroMinColor;\n            zeroMaxColor[0] = scalarsMaxColor[0]*0.33;\n            zeroMaxColor[1] = scalarsMaxColor[1]*0.33;\n            zeroMaxColor[2] = scalarsMaxColor[2]*0.33;\n            zeroMinColor[0] = scalarsMinColor[0]*0.33;\n            zeroMinColor[1] = scalarsMinColor[1]*0.33;\n            zeroMinColor[2] = scalarsMinColor[2]*0.33;\n            if(scalarValue < 0.0) {fragmentColor = scalarValue/(scalarsMin) * scalarsMinColor + (1.0 - scalarValue/(scalarsMin)) * (zeroMinColor);}\n            else {fragmentColor = scalarValue/(scalarsMax) * scalarsMaxColor + (1.0 - scalarValue/(scalarsMax)) * (zeroMaxColor);}\n        } else {\n            fragmentColor = scalarValue * scalarsMaxColor + (1.0 - scalarValue) * scalarsMinColor;\n          }\n      } else {\n        fragmentColor = vertexColor;\n      }\n    }\n  } else if (useObjectColor) {\n    fragmentColor = objectColor;\n  } else {\n    fragmentColor = vertexColor;\n  }\n  gl_PointSize = pointSize;\n  gl_Position = perspective * fVertexPosition;\n}\n";
this.rd="";this.rd="precision mediump float;\n\nuniform bool usePicking;\nuniform bool useTexture;\nuniform bool volumeTexture;\nuniform bool useLabelMapTexture;\nuniform sampler2D textureSampler;\nuniform sampler2D textureSampler2;\nuniform float objectOpacity;\nuniform float labelmapOpacity;\nuniform float volumeLowerThreshold;\nuniform float volumeUpperThreshold;\nuniform float volumeScalarMin;\nuniform float volumeScalarMax;\nuniform vec3 volumeScalarMinColor;\nuniform vec3 volumeScalarMaxColor;\nuniform float volumeWindowLow;\nuniform float volumeWindowHigh;\n\nvarying float fDiscardNow;\nvarying vec4 fVertexPosition;\nvarying vec3 fragmentColor;\nvarying vec2 fragmentTexturePos;\nvarying vec3 fVertexNormal;\nvarying vec3 fTransformedVertexNormal;\n\nvoid main(void) {\n if (fDiscardNow > 0.0) {\n   discard;\n }\n if (usePicking) {\n   gl_FragColor = vec4(fragmentColor, 1.0);\n } else if (useTexture) {\n   vec4 texture1 = texture2D(textureSampler,fragmentTexturePos);\n   vec4 textureSum = texture1;\n   if (volumeTexture) {\n     float _windowLow = (volumeWindowLow / volumeScalarMax);\n     float _windowHigh = (volumeWindowHigh / volumeScalarMax);\n     vec3 _minrange = vec3(_windowLow,_windowLow,_windowLow);\n     vec3 _maxrange = vec3(_windowHigh,_windowHigh,_windowHigh);\n     vec3 fac = _maxrange - _minrange;\n     textureSum = vec4((textureSum.r - _minrange)/fac,1);\n     textureSum = textureSum.r * vec4(volumeScalarMaxColor,1) + (1.0 - textureSum.r) * vec4(volumeScalarMinColor,1);\n   }\n   if (useLabelMapTexture) {\n     vec4 texture2 = texture2D(textureSampler2,fragmentTexturePos);\n     if (texture2.a > 0.0) {\n       if (labelmapOpacity < 1.0) {\n         textureSum = mix(texture2, textureSum, 1.0 - labelmapOpacity);\n       } else {\n         textureSum = texture2;\n       }\n     }\n   }\n   if (volumeTexture) {\n     float _volumeLowerThreshold = (volumeLowerThreshold / volumeScalarMax);\n     float _volumeUpperThreshold = (volumeUpperThreshold / volumeScalarMax);\n     if (texture1.r < _volumeLowerThreshold ||\n         texture1.r > _volumeUpperThreshold) {\n       discard;\n     };\n   };\n   gl_FragColor = textureSum;\n   gl_FragColor.a = objectOpacity;\n } else {\n   vec3 nNormal = normalize(fTransformedVertexNormal);\n   if (fVertexNormal == vec3(0.0,0.0,0.0)) {\n     gl_FragColor = vec4(fragmentColor,1.0);\n     return;\n   }\n   vec3 light = vec3(0.0, 0.0, 1.0);\n   vec3 lightDirection = vec3(0,0,-10);\n   lightDirection = normalize(lightDirection);\n   vec3 eyeDirection = normalize(-fVertexPosition.xyz);\n   vec3 reflectionDirection = reflect(-lightDirection, nNormal);\n   float specular = pow(max(dot(reflectionDirection, eyeDirection), 0.0), 10.0);\n   float diffuse = 0.8 * max(dot(nNormal, light), 0.0);\n   float ambient = 0.3;\n   gl_FragColor = vec4(fragmentColor * ambient +\n                       fragmentColor * diffuse +\n                       vec3(0.2, 0.2, 0.2) * specular,\n                       objectOpacity);\n }\n}\n"}
H(Ae,O);
var Be={tj:"vertexPosition",sj:"vertexNormal",rj:"vertexColor",vj:"vertexTexturePos",uj:"vertexScalar"},Ce={wj:"view",aj:"perspective",Ti:"center",$i:"objectTransform",nj:"useObjectColor",Yi:"objectColor",pj:"useScalars",jj:"scalarsReplaceMode",gj:"scalarsMin",dj:"scalarsMax",hj:"scalarsMinColor",ej:"scalarsMaxColor",ij:"scalarsMinThreshold",fj:"scalarsMaxThreshold",cj:"scalarsInterpolation",bj:"pointSize",Zi:"objectOpacity",Xi:"normal",oj:"usePicking",qj:"useTexture",mj:"useLabelMapTexture",Vi:"labelmapOpacity",
kj:"textureSampler",lj:"textureSampler2",xj:"volumeLowerThreshold",Dj:"volumeUpperThreshold",Aj:"volumeScalarMin",yj:"volumeScalarMax",Bj:"volumeScalarMinColor",zj:"volumeScalarMaxColor",Fj:"volumeWindowLow",Ej:"volumeWindowHigh",Cj:"volumeTexture"};
function De(a){var b=Object.keys(Ce);Object.keys(Be).every(function(a){a=Be[a];return-1!=this.Dd.search(a)||-1!=this.rd.search(a)}.bind(a))||i(Error("Could not find all attributes in the shader sources."));b.every(function(a){a=Ce[a];return-1!=this.Dd.search(a)||-1!=this.rd.search(a)}.bind(a))||i(Error("Could not find all uniforms in the shader sources."))};function Ee(a){V.call(this);this.c="slice";this.l=[0,0,0];this.lc=[0,0,1];this.J=[0,1,0];this.H=this.K=10;this.Wb=[0,1,0,0,1,1,1,1,1,0,0,0];this.n=this.bb=q;this.Qa=o;this.hc=[1,1,1];y(a)&&this.$b(a)}H(Ee,V);Ee.prototype.$b=function(a){this.l=a.l.slice();this.lc=a.lc.slice();this.J=a.J.slice();this.K=a.K;this.H=a.H;this.bb=a.bb;this.n=a.n;this.Qa=a.Qa;this.hc=a.hc;this.Pg=a.Pg;Ee.k.$b.call(this,a)};
Ee.prototype.rc=function(){var a=new Q(this.lc[0],this.lc[1],this.lc[2]),b=new Q(this.J[0],this.J[1],this.J[2]),c=Sc(b,a),d=new Q(this.l[0],this.l[1],this.l[2]),e=new Q(1,1,1);1==a.x?(e=new Q(this.l[0],this.H/2,this.K/2),this.Wb=[0,0,1,0,0,1,0,1,1,1,1,0]):1==a.y?(e=new Q(this.K/2,this.l[1],this.H/2),this.Wb=[0,0,0,1,1,0,1,0,1,1,0,1]):1==a.b&&(e=new Q(this.K/2,this.H/2,this.l[2]));var f=Rc(c.f().W(),b.f().W()),f=new Q(f.x*e.x,f.y*e.y,f.b*e.b);f.add(d);var g=Rc(c.f().W(),b),g=new Q(g.x*e.x,g.y*e.y,
g.b*e.b);g.add(d);var h=Rc(c,b.f().W()),h=new Q(h.x*e.x,h.y*e.y,h.b*e.b);h.add(d);var l=h,b=Rc(c,b),b=new Q(b.x*e.x,b.y*e.y,b.b*e.b);b.add(d);d=g;this.g=new T(18);this.h=new T(18);this.g.add(f.x,f.y,f.b);this.g.add(g.x,g.y,g.b);this.g.add(h.x,h.y,h.b);this.g.add(l.x,l.y,l.b);this.g.add(b.x,b.y,b.b);this.g.add(d.x,d.y,d.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.Qa&&(a=new V,a.g=new T(24),a.h=
new T(24),a.g.add(f.x,f.y,f.b),a.g.add(g.x,g.y,g.b),a.g.add(g.x,g.y,g.b),a.g.add(b.x,b.y,b.b),a.g.add(b.x,b.y,b.b),a.g.add(h.x,h.y,h.b),a.g.add(h.x,h.y,h.b),a.g.add(f.x,f.y,f.b),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.Fb=[this.hc[0],this.hc[1],this.hc[2]],a.ia="LINES",a.nc=2,this.d.push(a))};E("X.slice",Ee);function P(a){V.call(this);this.c="volume";this.l=[0,0,0];this.Y=[10,10,10];this.D=[1,1,1];this.lb=[];this.Fc=this.ob=this.Ec=this.nb=this.Dc=this.mb=0;this.P=new V;this.Q=new V;this.$a=new V;this.Ed=this.Ha=r;this.Bb=0;this.n=q;this.Qa=o;this.ea=Infinity;this.da=-Infinity;wa(this,new Nc);wa(this,new pd);y(a)&&this.$b(a)}H(P,V);
P.prototype.$b=function(a){window.console.log(a);this.l=a.l.slice();this.Y=a.Y.slice();this.D=a.D.slice();this.mb=a.mb;this.Dc=a.Dc;this.nb=a.nb;this.Ec=a.Ec;this.ob=a.ob;this.Fc=a.Fc;this.P=new V(a.P);this.Q=new V(a.Q);this.$a=new V(a.$a);this.Ha=a.Ha;this.Ed=a.Ed;this.Bb=a.Bb;this.n=a.n;this.Qa=a.Qa;P.k.$b.call(this,a)};
P.prototype.rc=function(){this.d.length=0;this.P.d.length=0;this.Q.d.length=0;this.$a.d.length=0;this.d.push(this.P);this.d.push(this.Q);this.d.push(this.$a);for(var a=0,a=0;3>a;a++){for(var b=(this.Y[a]-1)/2,c=b,d=0,d=0;d<this.Y[a];d++){var e=-b*this.D[a]+d*this.D[a],f=[[this.l[0]+e,this.l[1],this.l[2]],[this.l[0],this.l[1]+e,this.l[2]],[this.l[0],this.l[1],this.l[2]+e]],e=this.d[a].d,g=0,h=0,l=[1,1,1],k=this.Qa;0==a?(g=this.Y[2]*this.D[2]-this.D[2],h=this.Y[1]*this.D[1]-this.D[1],l=[1,1,0]):1==
a?(g=this.Y[0]*this.D[0]-this.D[0],h=this.Y[2]*this.D[2]-this.D[2],l=[1,0,0]):2==a&&(g=this.Y[0]*this.D[0]-this.D[0],h=this.Y[1]*this.D[1]-this.D[1],l=[0,1,0]);y(this.bb)&&(k=r);var j=new Ee,n=j,f=f[a],s=[[1,0,0],[0,1,0],[0,0,1]][a],p=[[0,1,0],[0,0,-1],[0,1,0]][a];(!y(f)||!C(f)||3!=f.length)&&i(Error("Invalid center."));(!y(s)||!C(s)||3!=s.length)&&i(Error("Invalid front direction."));(!y(p)||!C(p)||3!=p.length)&&i(Error("Invalid up direction."));D(g)||i(Error("Invalid width."));D(h)||i(Error("Invalid height."));
var w=r;y(k)&&(w=k);k=[1,1,1];y(l)&&(k=l);n.l=f;n.lc=s;n.J=p;n.K=g;n.H=h;n.Qa=w;n.hc=k;n.rc();j.bb=this;j.visible=d==Math.floor(c);e.push(j)}0==a?this.Dc=this.mb=c:1==a?this.Ec=this.nb=c:2==a&&(this.Fc=this.ob=c)}this.e=o};
P.prototype.o=function(a){a="undefined"!==typeof a?a:o;if(0<this.d.length)if(this.Ha!=this.Ed&&(this.Ha?(this.d[0].d[parseInt(this.mb,10)].visible=r,this.d[1].d[parseInt(this.nb,10)].visible=r,this.d[2].d[parseInt(this.ob,10)].visible=r):this.d[this.Bb].visible=r,this.e=o,this.Ed=this.Ha),this.Ha)Fe(this,this.Bb);else for(var b=0,b=0;3>b;b++){var c=this.d[b],d=0,e=0;0==b?(d=this.mb,e=this.Dc,this.Dc=this.mb):1==b?(d=this.nb,e=this.Ec,this.Ec=this.nb):2==b&&(d=this.ob,e=this.Fc,this.Fc=this.ob);c.d[parseInt(e,
10)].visible=r;c=c.d[parseInt(d,10)];c.visible=o;c.V=1}a&&P.k.o.call(this)};P.prototype.__defineGetter__("dimensions",t("Y"));P.prototype.__defineGetter__("volumeRendering",t("Ha"));P.prototype.__defineSetter__("volumeRendering",function(a){this.Ha=a;this.o(r)});P.prototype.__defineSetter__("visible",ba("Ga"));P.prototype.__defineGetter__("center",t("l"));P.prototype.__defineSetter__("center",function(a){(!y(a)||!C(a)||3!=a.length)&&i(Error("Invalid center."));this.l=a});
P.prototype.__defineGetter__("spacing",t("D"));P.prototype.__defineGetter__("image",t("lb"));P.prototype.__defineGetter__("labelmap",function(){this.n||(this.n=new Ge(this));return this.n});P.prototype.__defineGetter__("indexX",t("mb"));P.prototype.__defineSetter__("indexX",function(a){D(a)&&0<=a&&a<this.P.d.length&&(this.mb=a,this.o(r))});P.prototype.__defineGetter__("indexY",t("nb"));P.prototype.__defineSetter__("indexY",function(a){D(a)&&0<=a&&a<this.Q.d.length&&(this.nb=a,this.o(r))});
P.prototype.__defineGetter__("indexZ",t("ob"));P.prototype.__defineSetter__("indexZ",function(a){D(a)&&0<=a&&a<this.$a.d.length&&(this.ob=a,this.o(r))});P.prototype.__defineGetter__("windowLow",t("ea"));P.prototype.__defineSetter__("windowLow",ba("ea"));P.prototype.__defineGetter__("windowHigh",t("da"));P.prototype.__defineSetter__("windowHigh",ba("da"));P.prototype.__defineGetter__("borders",t("Qa"));P.prototype.__defineSetter__("borders",ba("Qa"));
function Fe(a,b){if(a.Ha&&(a.e||b!=a.Bb)){var c=a.d[a.Bb];c.visible=r;var c=a.d[b],d=c.d.length,e;for(e=0;e<d;e++)c.d[e].Ga=o;a.Bb=b;a.e=r}}E("X.volume",P);E("X.volume.prototype.modified",P.prototype.o);function He(){Z.call(this);this.c="parserSTL"}H(He,Z);
He.prototype.parse=function(a,b,c){I.Ea(this.c+".parse");this.aa=c;var d=b.g,e=b.h;if("solid"==String.fromCharCode.apply(q,$(this,"uchar",5))){b.g=d=new T(c.byteLength);b.h=e=new T(c.byteLength);var f=d,d=e,e=$(this,"uchar",c.byteLength-5),c=e.length,g=r,h=r,l=0,k;for(k=0;k<c;k++)if(10==e[k]){if(g||h){var j=String.fromCharCode.apply(q,e.subarray(l,k)).split(" "),h=parseFloat(j[0]),n=parseFloat(j[1]),j=parseFloat(j[2]);g?(d.add(h,n,j),d.add(h,n,j),d.add(h,n,j)):f.add(h,n,j);h=g=r}}else 32==e[k-1]&&
(102==e[k]?(l=k+=13,g=o):118==e[k]&&(l=k+=7,h=o))}else{this.w=80;f=$(this,"uint");b.g=d=new T(9*f);b.h=e=new T(9*f);for(c=c=0;c<f;c++)g=$(this,"float",12),l=g[0],k=g[1],h=g[2],e.add(l,k,h),e.add(l,k,h),e.add(l,k,h),d.add(g[3],g[4],g[5]),d.add(g[6],g[7],g[8]),d.add(g[9],g[10],g[11]),this.w+=2}I.ya(this.c+".parse");f=new rd;f.Z=b;f.s=a;this.dispatchEvent(f)};E("X.parserSTL",He);E("X.parserSTL.prototype.parse",He.prototype.parse);function Ie(a){function b(){yc+=8;return S<ya.length?ya[S++]:-1}function c(){var a;yc++;a=sa&1;sa>>=1;0==sa&&(sa=b(),a=sa&1,sa=sa>>1|128);return a}function d(a){for(var b=0,d=a;d--;)b=b<<1|c();a&&(b=W[b]>>8-a);return b}function e(a){x[A++]=a;if(N==w-1){var b=new Uint8Array(2*w);b.set(p);p=b;w*=2}p[N++]=a;32768==A&&(A=0)}function f(){this.Gd=this.Fd=0;this.Pe=q}function g(){for(;;){if(pb[Ca]>=kd)return-1;if(zc[pb[Ca]]==Ca)return pb[Ca]++;pb[Ca]++}}function h(){var a=Ac[Hb],b;if(17==Ca)return-1;Hb++;
Ca++;b=g();if(0<=b)a.Fd=b;else if(a.Fd=32768,h())return-1;b=g();if(0<=b)a.Gd=b,a.Pe=q;else if(a.Gd=32768,a.Pe=Ac[Hb],a.Ij=Hb,h())return-1;Ca--;return 0}function l(a,b,c){Ac=a;Hb=0;zc=c;kd=b;for(a=0;17>a;a++)pb[a]=0;Ca=0;return h()?-1:0}function k(a){for(var b,d,e=0,f=a[e];;)if(b=c()){if(!(f.Gd&32768))return f.Gd;f=f.Pe;b=a.length;for(d=0;d<b;d++)if(a[d]===f){e=d;break}}else{if(!(f.Fd&32768))return f.Fd;e++;f=a[e]}}function j(){var a,g,h,j,n;do if(a=c(),h=d(2),0==h){sa=1;h=b();h|=b()<<8;for(b(),b();h--;)g=
b(),e(g)}else if(1==h)for(;;)if(h=W[d(7)]>>1,23<h?(h=h<<1|c(),199<h?(h-=128,h=h<<1|c()):(h-=48,143<h&&(h+=136))):h+=256,256>h)e(h);else if(256==h)break;else{var p;h-=257;n=d(K[h])+G[h];h=W[d(5)]>>3;8<R[h]?(p=d(8),p|=d(R[h]-8)<<8):p=d(R[h]);p+=J[h];for(h=0;h<n;h++)g=x[A-p&32767],e(g)}else if(2==h){var s=Array(320);g=257+d(5);p=1+d(5);j=4+d(4);for(h=0;19>h;h++)s[h]=0;for(h=0;h<j;h++)s[ga[h]]=d(3);n=ib.length;for(j=0;j<n;j++)ib[j]=new f;if(l(ib,19,s)){A=0;return}n=g+p;j=0;for(var v=-1;j<n;)if(v++,h=
k(ib),16>h)s[j++]=h;else if(16==h){var w;h=3+d(2);if(j+h>n){A=0;return}for(w=j?s[j-1]:0;h--;)s[j++]=w}else{h=17==h?3+d(3):11+d(7);if(j+h>n){A=0;return}for(;h--;)s[j++]=0}n=Jb.length;for(j=0;j<n;j++)Jb[j]=new f;if(l(Jb,g,s)){A=0;return}n=Jb.length;for(j=0;j<n;j++)ib[j]=new f;h=[];for(j=g;j<s.length;j++)h[j-g]=s[j];if(l(ib,p,h)){A=0;return}for(;;)if(h=k(Jb),256<=h){h-=256;if(0==h)break;h--;n=d(K[h])+G[h];h=k(ib);8<R[h]?(p=d(8),p|=d(R[h]-8)<<8):p=d(R[h]);for(p+=J[h];n--;)g=x[A-p&32767],e(g)}else e(h)}while(!a);
A=0;sa=1}function n(){var a=[],c;v&8&&(a[0]=b(),a[1]=b(),a[2]=b(),a[3]=b(),80==a[0]&&75==a[1]&&7==a[2]&&8==a[3]&&(b(),b(),b(),b()),b(),b(),b(),b(),b(),b(),b(),b());F&&s(ya.byteLength);a[0]=b();if(8==a[0]){v=b();b();b();b();b();b();b();if(v&4){a[0]=b();a[2]=b();Ca=a[0]+256*a[1];for(a=0;a<Ca;a++)b()}if(v&8){a=0;for(qb=[];c=b();){if("7"==c||":"==c)a=0;a<ld-1&&(qb[a++]=c)}}if(v&16)for(;b(););v&2&&(b(),b());j();b();b();b();b();b();b();b();b();F&&s(ya.byteLength)}}function s(a){w=a;p=new Uint8Array(a);
a=[];F=r;a[0]=b();a[1]=b();120==a[0]&&218==a[1]&&(j(),B[z]=Array(2),B[z][0]=p,B[z][1]="geonext.gxt",z++);31==a[0]&&139==a[1]&&(n(),B[z]=Array(2),B[z][0]=p,B[z][1]="file",z++);if(80==a[0]&&75==a[1]&&(F=o,a[2]=b(),a[3]=b(),3==a[2]&&4==a[3])){a[0]=b();a[1]=b();v=b();v|=b()<<8;a=b();a|=b()<<8;b();b();b();b();b();b();b();b();b();b();b();b();b();b();b();b();var c=b(),c=c|b()<<8,d=b(),d=d|b()<<8,e=0;for(qb=[];c--;){var f=b();"/"==f|":"==f?e=0:e<ld-1&&(qb[e++]=String.fromCharCode(f))}md||(md=qb);for(e=0;e<
d;)b(),e++;N=0;8==a&&(j(),B[z]=Array(2),B[z][0]=p,B[z][1]=qb.join(""),z++);n()}}var p=q,w=0,v,z=0,B=[],x=Array(32768),A=0,F=r,N=0,W=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,
22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,
175,111,239,31,159,95,223,63,191,127,255],G=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],K=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],J=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],R=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ga=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ya=a,S=0,sa=1,yc=0,ld=256,qb=[],md,Jb=Array(288),ib=Array(32),
Hb=0,Ac=q,Ca=0,pb=Array(17);pb[0]=0;var zc,kd;Ie.prototype.mf=function(){s(ya.byteLength);return p}};function Je(){Z.call(this);this.c="parserDCM"}H(Je,Z);Je.prototype.parse=function(a,b,c){c=this.ed(c,b);if(c.Td==c.Va){var d=c.gf.length,e,f=0;for(e=0;e<d;e++){var g=c.gf[e];g!==m&&(g*=c.ib,g=c.Uc.subarray(g,g+c.ib),c.data.set(g,f*c.ib),f++)}b.Y=[c.ra[0],c.ra[1],c.ra[2]];b.D=[c.cb[0],c.cb[1],c.cb[2]];e=se(c.data);d=e[0];e=e[1];c.min=b.Fa=b.ea=d;c.max=b.Aa=b.da=e;-Infinity==b.ba&&(b.ba=d);Infinity==b.ca&&(b.ca=e);b.rc();b.lb=te(this,b,c)}c=new rd;c.Z=b;c.s=a;this.dispatchEvent(c)};
Je.prototype.ed=function(a,b){this.aa=a;if(y(b.gc)){d=b.gc;f=d.Zf;h=d.Yf;this.w=2*f;var c=$(this,"uchar",h),c=parseInt(String.fromCharCode.apply(q,c),10);d.ra[2]++}else{var d={rows:0,cols:0,cb:q,ye:0,Wg:0,Va:1,Jh:1,Zf:0,Yf:0,Td:0,ib:0,Uc:q,bf:0,gf:[],data:q,min:Infinity,max:-Infinity};d.Va=b.p.length;y(d.Va)||(d.Va=1);for(var e=$(this,"ushort",this.aa.byteLength),f=66,g=h=q,h=q,c="",l=7;0<l;)if(h=e[f++],40==h)switch(g=e[f++],f++,h=e[f++],g){case 16:d.rows=e[f++];l--;break;case 17:d.cols=e[f++];l--;
break;case 256:d.ye=e[f++];l--;break;case 257:d.Wg=e[f++];l--;break;case 2:d.Jh=e[f++];l--;break;case 48:for(var g="",k=0,k=0;k<h/2;k++)var j=e[f++],n=j&255,j=(j&65280)>>8,g=g+String.fromCharCode(n),g=g+String.fromCharCode(j);g=g.split("\\");d.cb=[+g[0],+g[1],1];l--}else if(32==h&&(g=e[f++],19==g)){f++;h=e[f++];d.Zf=f;d.Yf=h;for(k=0;k<h/2;k++)j=e[f++],n=j&255,j=(j&65280)>>8,c+=String.fromCharCode(n),c+=String.fromCharCode(j),c=parseInt(c,10);l--}b.gc=d;d.ra=[d.cols,d.rows,1];d.ib=d.rows*d.cols;switch(d.ye){case 8:d.Uc=
new Uint8Array(d.cols*d.rows*d.Va);d.data=new Uint8Array(d.cols*d.rows*d.Va);break;case 16:d.Uc=new Uint16Array(d.cols*d.rows*d.Va);d.data=new Uint16Array(d.cols*d.rows*d.Va);break;case 32:d.Uc=new Uint32Array(d.cols*d.rows*d.Va),d.data=new Uint32Array(d.cols*d.rows*d.Va)}}this.w=this.aa.byteLength-2*d.ib;e=q;switch(d.ye){case 8:e=$(this,"uchar",d.ib);break;case 16:e=$(this,"ushort",d.ib);break;case 32:e=$(this,"uint",d.ib)}d.gf[c]=d.bf;d.Uc.set(e,d.bf*d.ib);d.bf++;++d.Td;return d};
E("X.parserDCM",Je);E("X.parserDCM.prototype.parse",Je.prototype.parse);function Ke(){Z.call(this);this.c="parserVTK"}H(Ke,Z);
Ke.prototype.parse=function(a,b,c){I.Ea(this.c+".parse");var d=b.g,e=b.h,f=new Uint8Array(c),g="";b.g=d=new T(c.byteLength);b.h=e=new T(c.byteLength);for(var c=0,h=f.length;c<h;c+=32768)g+=String.fromCharCode.apply(q,f.subarray(c,Math.min(c+32768,h)));f=g.split("\n");g=f.length;this.Qc=this.Rc=q;this.Ib=[];this.oa=od;this.pe=this.wb=this.kb=this.xb=r;c=0;for(h=g%8;h--;)Le(this,f[c]),c++;for(h=0.125*g^0;h--;)Le(this,f[c]),c++,Le(this,f[c]),c++,Le(this,f[c]),c++,Le(this,f[c]),c++,Le(this,f[c]),c++,
Le(this,f[c]),c++,Le(this,f[c]),c++,Le(this,f[c]),c++;var c=this.Rc,f=this.Qc,g=f.length,l=h=this.Ib.length;do{var k=this.Ib[h-l],j=k.length,n;for(n=0;n<j&&!("LINES"==this.oa&&n+1>=j);n++){var s=parseInt(k[n],10),p=c.get(s);d.add(p[0],p[1],p[2]);var w=s,v=p;"LINES"==this.oa?(w=parseInt(k[n+1],10),v=c.get(w),d.add(v[0],v[1],v[2])):"TRIANGLE_STRIPS"==this.oa&&(0==n||n==j-1)&&d.add(p[0],p[1],p[2]);s<g?(v=f.get(s),e.add(v[0],v[1],v[2]),"LINES"==this.oa?(w=f.get(w),e.add(w[0],w[1],w[2])):"TRIANGLE_STRIPS"==
this.oa&&(0==n||n==j-1)&&e.add(v[0],v[1],v[2])):(w=new Q(p[0],p[1],p[2]),w.normalize(),e.add(w.x,w.y,w.b),"LINES"==this.oa?(w=new Q(v[0],v[1],v[2]),w.normalize(),e.add(w.x,w.y,w.b)):"TRIANGLE_STRIPS"==this.oa&&(0==n||n==j-1)&&e.add(w.x,w.y,w.b))}l--}while(0<l);b.ia=this.oa;I.ya(this.c+".parse");d=new rd;d.Z=b;d.s=a;this.dispatchEvent(d)};
function Le(a,b){var b=b.replace(/^\s+|\s+$/g,""),c=b.split(" "),d=c.length,e=c[0];switch(e){case "POINTS":a.xb=o;a.kb=r;a.wb=r;c=parseInt(c[1],10);a.Rc=new T(3*c);a.Qc=new T(3*c);return;case "VERTICES":a.kb=o;a.xb=r;a.wb=r;c=parseInt(c[1],10);3<=c?a.oa=od:1==c?a.oa="POINTS":i(Error("This VTK file is not supported!"));a.Ib=[];return;case "TRIANGLE_STRIPS":a.kb=o;a.xb=r;a.wb=r;a.oa="TRIANGLE_STRIPS";a.Ib=[];return;case "LINES":a.kb=o;a.xb=r;a.wb=r;a.oa="LINES";a.Ib=[];return;case "POLYGONS":a.kb=o;
a.xb=r;a.wb=r;a.oa="POLYGONS";a.Ib=[];return;case "POINT_DATA":a.wb=o;a.xb=r;a.kb=r;return}if(a.xb)if(1==d||isNaN(parseFloat(e)))a.xb=r;else{if(3<=d){var e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]);a.Rc.add(e,f,g)}6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.Rc.add(e,f,g));9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.Rc.add(d,e,c))}else a.kb?1==d||isNaN(parseFloat(e))?a.kb=r:a.Ib.push(c.slice(1)):a.wb&&("NORMALS"==e?a.pe=o:1==d||isNaN(parseFloat(e))?
(a.wb=r,a.pe=r):a.pe&&(3<=d&&(e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]),a.Qc.add(e,f,g)),6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.Qc.add(e,f,g)),9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.Qc.add(d,e,c))))}E("X.parserVTK",Ke);E("X.parserVTK.prototype.parse",Ke.prototype.parse);function Me(){Z.call(this);this.c="parserFSM";this.sd=r}H(Me,Z);
Me.prototype.parse=function(a,b,c){I.Ea(this.c+".parse");this.aa=c;var d=b.g,e=b.h;b.oc=[];var f=b.oc,c=0,g;do g=$(this,"uchar"),c++;while(200>c&&10!=g);$(this,"uchar");var e=$(this,"uint"),c=$(this,"uint"),h=$(this,"float",3*e);g=$(this,"uint",3*c);var l=new Uint32Array(e),k=new Float32Array(9*c);b.g=d=new T(9*c);b.h=e=new T(9*c);var j;for(j=0;j<c;j++){var n=3*j,s=g[n],p=g[n+1],w=g[n+2];f.push(s);f.push(p);f.push(w);l[s]+=1;l[p]+=1;l[w]+=1;var n=3*s,v=3*p,z=3*w,B=h[n],x=h[n+1],A=h[n+2],p=h[v],w=
h[v+1],s=h[v+2],F=h[z],N=h[z+1],W=h[z+2];d.add(B,x,A);d.add(p,w,s);d.add(F,N,W);B=new Q(B,x,A);F=new Q(F,N,W);p=(new Q(p,w,s)).f().gb(B);w=F.f().gb(B);p=Sc(p,w).normalize();k[n]+=p.x;k[n+1]+=p.y;k[n+2]+=p.b;k[v]+=p.x;k[v+1]+=p.y;k[v+2]+=p.b;k[z]+=p.x;k[z+1]+=p.y;k[z+2]+=p.b}for(j=0;j<c;j++)n=3*j,s=g[n],p=g[n+1],w=g[n+2],n=3*s,v=3*p,z=3*w,f=new Q(k[v],k[v+1],k[v+2]),h=new Q(k[z],k[z+1],k[z+2]),n=(new Q(k[n],k[n+1],k[n+2])).scale(1/l[s]).normalize(),f=f.scale(1/l[p]).normalize(),h=h.scale(1/l[w]).normalize(),
e.add(n.x,n.y,n.b),e.add(f.x,f.y,f.b),e.add(h.x,h.y,h.b);b.ia=od;I.ya(this.c+".parse");c=new rd;c.Z=b;c.s=a;this.dispatchEvent(c)};E("X.parserFSM",Me);E("X.parserFSM.prototype.parse",Me.prototype.parse);function Ne(){Z.call(this);this.c="parserMGZ";this.sd=r}H(Ne,Z);Ne.prototype.parse=function(a,b,c,d){I.Ea(this.c+".parse");var e=c;d&&(e=(new Ie(new Uint8Array(c))).mf(),e=e.buffer);c=this.ed(e);b.Y=[c.Se,c.Te,c.Ue];b.D=c.Cg;d=c.min;e=c.max;b.Fa=b.ea=d;b.Aa=b.da=e;-Infinity==b.ba&&(b.ba=d);Infinity==b.ca&&(b.ca=e);b.rc();I.ya(this.c+".parse");b.lb=te(this,b,c);c=new rd;c.Z=b;c.s=a;this.dispatchEvent(c)};
Ne.prototype.ed=function(a){this.aa=a;a={version:0,Jg:0,Hg:0,nh:0,Ig:0,Se:0,Te:0,Ue:0,Ih:0,type:0,gh:0,tg:0,Wi:q,Gg:q,Cg:q,data:q,min:Infinity,max:-Infinity};a.version=$(this,"uint");a.Se=$(this,"uint");a.Te=$(this,"uint");a.Ue=$(this,"uint");a.Ih=$(this,"uint");a.type=$(this,"uint");a.gh=$(this,"uint");a.tg=$(this,"ushort");if(0<a.tg){a.Cg=$(this,"float",3);var b=[];b.push($(this,"float",3));b.push($(this,"float",3));b.push($(this,"float",3));b.push($(this,"float",3));a.Gg=b}this.w=284;b=a.Se*a.Te*
a.Ue;switch(a.type){case 0:a.data=$(this,"uchar",b);break;case 1:a.data=$(this,"uint",b);break;case 3:a.data=$(this,"float",b);break;case 4:a.data=$(this,"ushort",b);break;default:i(Error("Unsupported MGH/MGZ data type: "+a.type))}b=se(a.data);a.min=b[0];a.max=b[1];this.w+16<this.aa.byteLength&&(a.Jg=$(this,"float"),a.nh=$(this,"float"),a.Hg=$(this,"float"),a.Ig=$(this,"float"));return a};E("X.parserMGZ",Ne);E("X.parserMGZ.prototype.parse",Ne.prototype.parse);function Oe(){Z.call(this);this.c="parserLBL"}H(Oe,Z);
Oe.prototype.parse=function(a,b,c){I.Ea(this.c+".parse");var d=b.oc,e=d.length;0==e&&i(Error("No _pointIndices defined on the X.object."));this.aa=c;for(var f=[],g=$(this,"uchar",c.byteLength),h=g.length,l=r,k=0,c=1;c<h;c++)10==g[c-1]?(k=c,l=o):l&&32==g[c]&&(l=parseInt(String.fromCharCode.apply(q,g.subarray(k,c)),10),f.push(l),l=r);g=b.r.t?b.r.t:new Float32Array(e);h=f.length;for(c=0;c<h;c++)g[f[c]]=1;f=new Float32Array(3*e);for(c=h=0;c<e;c++)k=d[c],k>e&&i(Error("Could not find scalar for vertex.")),
k=g[k],f[h++]=k,f[h++]=k,f[h++]=k;b.r.t=g;b.r.Cc=f;b.r.e=o;I.ya(this.c+".parse");d=new rd;d.Z=b;d.s=a;this.dispatchEvent(d)};E("X.parserLBL",Oe);E("X.parserLBL.prototype.parse",Oe.prototype.parse);function Pe(){Z.call(this);this.c="parserCRV";this.sd=r}H(Pe,Z);
Pe.prototype.parse=function(a,b,c){I.Ea(this.c+".parse");var d=b.oc;0==d.length&&i(Error("No _pointIndices defined on the X.object."));this.aa=c;this.w=3;var e=$(this,"uint");$(this,"uint");$(this,"uint");var f=0,g=0,h=0,l=0,k=0,j=0,n=0,s=0,p=0,w=0,v=0,c=Array(2),z=Array(2),B=$(this,"float",e),x;for(x=0;x<e;x++){var A=B[x];0==x&&(c[0]=z[0]=A);0<=A?(f++,l+=A):(g++,h+=A);p+=A;v++;z[0]=Math.max(A,z[0]);c[0]=Math.min(A,c[0]);B[x]=A}0!=f&&(k=l/f);0!=g&&(j=h/g);0!=v&&(w=p/v);for(v=p=h=l=0;v<e;v++)A=B[v],
x=0,0<=A?(x=Math.pow(A-k,2),l+=x):(x=Math.pow(A-j,2),h+=x),x=Math.pow(A-w,2),p+=x;1<f&&(n=Math.sqrt(l/(f-1)));1<g&&(s=Math.sqrt(h/(g-1)));c[1]=j-2.5*s;z[1]=k+2.5*n;e=d.length;f=new Float32Array(3*e);for(v=0;v<e;v++)g=B[d[v]],h=3*v,f[h]=g,f[h+1]=g,f[h+2]=g;b.r.Fa=c[1];b.r.Aa=z[1];-Infinity==b.r.ba&&(b.r.ba=c[1]);Infinity==b.r.ca&&(b.r.ca=z[1]);b.r.t=B;b.r.Cc=f;b.r.e=o;I.ya(this.c+".parse");d=new rd;d.Z=b;d.s=a;this.dispatchEvent(d)};E("X.parserCRV",Pe);E("X.parserCRV.prototype.parse",Pe.prototype.parse);function Qe(){Z.call(this);this.c="parserTRK"}H(Qe,Z);
Qe.prototype.parse=function(a,b,c){I.Ea(this.c+".parse");var d=b.g,e=b.h,f=b.T;this.aa=c;$(this,"uchar",6);$(this,"ushort",3);var g=$(this,"float",3);$(this,"float",3);var h=$(this,"ushort");$(this,"uchar",200);$(this,"ushort");$(this,"uchar",200);$(this,"float",16);$(this,"uchar",444);$(this,"uchar",4);$(this,"uchar",4);$(this,"float",6);$(this,"uchar",2);$(this,"uchar");$(this,"uchar");$(this,"uchar");$(this,"uchar");$(this,"uchar");$(this,"uchar");var l=$(this,"uint");$(this,"uint");var k=$(this,
"uint"),j=[],n=[],c=Infinity,s=-Infinity,p=q,w=q,v=q,z=q,e=d=q,B=$(this,"uint",(this.aa.byteLength-1E3)/4);this.w=k;for(var x=$(this,"float",(this.aa.byteLength-1E3)/4),A=0,k=f=0;k<l;k++){for(var F=B[A],N=new T(3*F),W=0,G=0;G<F;G++){var K=x[A+3*G+G*h+1],J=x[A+3*G+G*h+2],R=x[A+3*G+G*h+3],K=K/g[0],J=J/g[1],R=R/g[2];N.add(K,J,R);if(0<G)var ga=N.get(G-1),W=W+Math.sqrt(Math.pow(K-ga[0],2)+Math.pow(J-ga[1],2)+Math.pow(R-ga[2],2));G<F-1&&(f+=6)}A+=3*F+F*h+1;G=N.Pb;F=N.Mb;K=N.Qb;J=N.Nb;R=N.Rb;ga=N.Ob;if(!p||
G<p)p=G;if(!w||F>w)w=F;if(!v||K<v)v=K;if(!z||J>z)z=J;if(!d||R<d)d=R;if(!e||ga>e)e=ga;j.push(N);n.push(W)}g=(p+w)/2;v=(v+z)/2;h=(d+e)/2;z=new Float32Array(f);b.g=d=new T(f);b.h=e=new T(f);b.T=f=new T(f);for(k=p=0;k<l;k++){w=j[k];B=w.count;W=n[k];c=Math.min(c,W);s=Math.max(s,W);for(G=0;G<B-1;G++){A=w.get(G);x=w.get(G+1);d.add(A[0],A[1],A[2]);d.add(x[0],x[1],x[2]);var N=A[0]-g,F=A[1]-v,K=A[2]-h,J=Math.sqrt(N*N+F*F+K*K),R=x[0]-g,ga=x[1]-v,ya=x[2]-h,S=Math.sqrt(R*R+ga*ga+ya*ya);e.add(N/J,F/J,K/J);e.add(R/
S,ga/S,ya/S);x=[Math.abs(x[0]-A[0]),Math.abs(x[1]-A[1]),Math.abs(x[2]-A[2])];A=Math.sqrt(x[0]*x[0]+x[1]*x[1]+x[2]*x[2]);x[0]/=A;x[1]/=A;x[2]/=A;f.add(x[0],x[1],x[2]);f.add(x[0],x[1],x[2]);z[p++]=W;z[p++]=W;z[p++]=W;z[p++]=W;z[p++]=W;z[p++]=W}}b.ia="LINES";l=new qd;l.Fa=c;l.Aa=s;l.ba=c;l.ca=s;l.Cc=z;l.Cf=r;l.e=o;b.r=l;I.ya(this.c+".parse");c=new rd;c.Z=b;c.s=a;this.dispatchEvent(c)};E("X.parserTRK",Qe);E("X.parserTRK.prototype.parse",Qe.prototype.parse);function Re(){Z.call(this);this.c="parserLUT"}H(Re,Z);
Re.prototype.parse=function(a,b,c){I.Ea(this.c+".parse");this.aa=c;var c=$(this,"uchar",c.byteLength),d=c.length,e=0,f;for(f=0;f<d;f++)if(10==c[f]){var g=String.fromCharCode.apply(q,c.subarray(e,f)),e=f+1,g=g.replace(/^\s+|\s+$/g,"");"#"!=g[0]&&(g=g.split(" "),g=g.filter(function(a){return""!=a}),6==g.length&&(g[2]=parseInt(g[2],10)/255,g[3]=parseInt(g[3],10)/255,g[4]=parseInt(g[4],10)/255,g[5]=parseInt(g[5],10)/255,a.add(parseInt(g[0],10),g[1],g[2],g[3],g[4],g[5],10)))}I.ya(this.c+".parse");c=new rd;
c.Z=b;c.s=a;this.dispatchEvent(c)};E("X.parserLUT",Re);E("X.parserLUT.prototype.parse",Re.prototype.parse);function Se(){Z.call(this);this.c="parserNRRD"}H(Se,Z);
Se.prototype.parse=function(a,b,c){I.Ea(this.c+".parse");this.aa=c;var c=$(this,"uchar",c.byteLength),d=c.length,e=q,f=0,g;for(g=1;g<d;g++)if(10==c[g-1]&&10==c[g]){e=String.fromCharCode.apply(q,c.subarray(0,g-2));f=g+1;break}var h,l,k,j,d=e.split(/\r?\n/);for(e=0,g=d.length;e<g;e++)if(h=d[e],h.match(/NRRD\d+/))this.Eh=o;else if(!h.match(/^#/)&&(j=h.match(/(.*):(.*)/)))l=j[1].trim(),h=j[2].trim(),(k=this.jh[l])?k.call(this,h):this[l]=h;this.Eh||i(Error("Not an NRRD file"));"raw"!==this.encoding&&"gzip"!==
this.encoding&&"gz"!==this.encoding&&i(Error("Only raw or gz/gzip encoding is allowed"));if(!this.Da&&(this.Da=[new Q(1,0,0),new Q(0,1,0),new Q(0,0,1)],this.hf)){d=[];for(j=0;2>=j;j++)d.push(!isNaN(this.hf[j])?this.Da[j].scale(this.hf[j]):m)}f=c.subarray(f);if("gzip"==this.encoding||"gz"==this.encoding)f=(new Ie(f)).mf();f=f.buffer;c={data:q,min:Infinity,max:-Infinity};c.data=new this.Eb(f);j=se(c.data);f=c.min=j[0];j=c.max=j[1];b.Y=[this.ef[0],this.ef[1],this.ef[2]];b.D=[(new Q(this.Da[0][0],this.Da[0][1],
this.Da[0][2])).dc(),(new Q(this.Da[1][0],this.Da[1][1],this.Da[1][2])).dc(),(new Q(this.Da[2][0],this.Da[2][1],this.Da[2][2])).dc()];b.Fa=b.ea=f;b.Aa=b.da=j;-Infinity==b.ba&&(b.ba=f);Infinity==b.ca&&(b.ca=j);b.rc();I.ya(this.c+".parse");b.lb=te(this,b,c);c=new rd;c.Z=b;c.s=a;this.dispatchEvent(c)};
Se.prototype.jh={type:function(a){switch(a){case "uchar":case "unsigned char":case "uint8":case "uint8_t":this.Eb=Uint8Array;break;case "signed char":case "int8":case "int8_t":this.Eb=Int8Array;break;case "short":case "short int":case "signed short":case "signed short int":case "int16":case "int16_t":this.Eb=Int16Array;break;case "ushort":case "unsigned short":case "unsigned short int":case "uint16":case "uint16_t":this.Eb=Uint16Array;break;case "int":case "signed int":case "int32":case "int32_t":this.Eb=
Int32Array;break;case "uint":case "unsigned int":case "uint32":case "uint32_t":this.Eb=Uint32Array;break;case "float":this.Eb=Float32Array;break;default:i(Error("Unsupported NRRD data type: "+a))}return this.type=a},endian:function(a){return a},encoding:function(a){return this.encoding=a},dimension:function(a){return this.ra=parseInt(a,10)},sizes:function(a){var b,c,d,e;d=a.split(/\s+/);e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(parseInt(a,10));return this.ef=e},"space directions":function(a){var b,
c,d;c=a.match(/\(.*?\)/g);return this.Da=function(){var a,f,g;g=[];for(a=0,f=c.length;a<f;a++)d=c[a],g.push(function(){var a,c,e,f;e=d.slice(1,-1).split(/,/);f=[];for(a=0,c=e.length;a<c;a++)b=e[a],f.push(parseFloat(b));return f}());return g}()},spacings:function(a){var b;b=a.split(/\s+/);var c,d,e;e=[];for(c=0,d=b.length;c<d;c++)a=b[c],e.push(parseFloat(a));return this.hf=e}};E("X.parserNRRD",Se);E("X.parserNRRD.prototype.parse",Se.prototype.parse);function Te(){Z.call(this);this.c="parserNII"}H(Te,Z);Te.prototype.parse=function(a,b,c){I.Ea(this.c+".parse");var d=c;348!=(new Uint32Array(c,0,1))[0]&&(d=(new Ie(new Uint8Array(c))).mf(),d=d.buffer);c=this.ed(d);b.Y=[c.ra[1],c.ra[2],c.ra[3]];b.D=[c.cb[1],c.cb[2],c.cb[3]];var d=c.min,e=c.max;b.Fa=b.ea=d;b.Aa=b.da=e;-Infinity==b.ba&&(b.ba=d);Infinity==b.ca&&(b.ca=e);b.rc();I.ya(this.c+".parse");b.lb=te(this,b,c);c=new rd;c.Z=b;c.s=a;this.dispatchEvent(c)};
Te.prototype.ed=function(a){this.aa=a;a={Ai:0,$g:q,ah:q,ih:0,ui:0,mi:0,eh:q,ra:q,zh:0,Ah:0,Bh:0,xh:0,Ge:0,Vg:0,Ei:0,cb:q,Dg:0,ti:0,si:0,Di:0,Bi:q,Si:q,Xg:0,Yg:0,Ci:0,Li:0,ph:0,qh:0,dh:q,Ug:q,fi:0,yi:0,ji:0,ki:0,li:0,gi:0,hi:0,ii:0,Fi:q,Gi:q,Hi:q,yh:q,Fh:q,data:q,min:Infinity,max:-Infinity};a.Ai=$(this,"uint");a.$g=$(this,"uchar",10);a.ah=$(this,"uchar",18);a.ih=$(this,"uint");a.ui=$(this,"ushort");a.mi=$(this,"uchar");a.eh=$(this,"uchar");a.ra=$(this,"ushort",8);a.zh=$(this,"float");a.Ah=$(this,"float");
a.Bh=$(this,"float");a.xh=$(this,"ushort");a.Ge=$(this,"ushort");a.Vg=$(this,"ushort");a.Ei=$(this,"ushort");a.cb=$(this,"float",8);a.Dg=$(this,"float");a.ti=$(this,"float");a.si=$(this,"float");a.Di=$(this,"ushort");a.Bi=$(this,"uchar");a.Si=$(this,"uchar");a.Xg=$(this,"float");a.Yg=$(this,"float");a.Ci=$(this,"float");a.Li=$(this,"float");a.ph=$(this,"uint",1);a.qh=$(this,"uint",1);a.dh=$(this,"uchar",80);a.Ug=$(this,"uchar",24);a.fi=$(this,"ushort");a.yi=$(this,"ushort");a.ji=$(this,"float");a.ki=
$(this,"float");a.li=$(this,"float");a.gi=$(this,"float");a.hi=$(this,"float");a.ii=$(this,"float");a.Fi=$(this,"float",4);a.Gi=$(this,"float",4);a.Hi=$(this,"float",4);a.yh=$(this,"uchar",16);a.Fh=$(this,"uchar",4);this.w=parseInt(a.Dg,10);var b=a.ra[1]*a.ra[2]*a.ra[3];switch(a.Ge){case 2:a.data=$(this,"uchar",b);break;case 4:a.data=$(this,"sshort",b);break;case 8:a.data=$(this,"sint",b);break;case 16:a.data=$(this,"float",b);break;case 256:a.data=$(this,"schar",b);break;case 512:a.data=$(this,"ushort",
b);break;case 768:a.data=$(this,"uint",b);break;default:i(Error("Unsupported NII data type: "+a.Ge))}b=se(a.data);a.min=b[0];a.max=b[1];return a};E("X.parserNII",Te);E("X.parserNII.prototype.parse",Te.prototype.parse);function Ue(){O.call(this);this.c="loader";this.mc=new Mb;this.Oc=0}H(Ue,O);function Ve(a,b){a.Oc+=b/a.mc.Ua()/3;a.Oc=Math.min(1,a.Oc);var c=new Qd;c.Df=a.Oc;a.dispatchEvent(c)}function We(a){var a=a.p.yd,b=a.split(".").pop().toUpperCase();b==a.toUpperCase()&&(b="");b in Xe||i(Error("The "+b+" file format is not supported."));return[a,b,Xe[b][0],Xe[b][1],Xe[b][2]]}
Ue.prototype.load=function(a,b){(!a||!b)&&i(Error("No container or object to load."));if(!Ob(this.mc.F,a.na)||this.mc.get(a.na)){this.mc.set(a.na,r);var c=We(a)[0];if(a.Hb!=q)this.parse(q,a,b);else{var d=new XMLHttpRequest;M(d,"abort",this.Pf.bind(this,d,a,b));M(d,"error",this.Pf.bind(this,d,a,b));M(d,"load",this.parse.bind(this,d,a,b));d.open("GET",c,o);d.responseType="arraybuffer";d.send(q)}}};
Ue.prototype.parse=function(a,b,c){Ve(this,1);setTimeout(function(){var d=We(b),e=d[3],d=new d[2];qc(d,wc,this.complete.bind(this));var f=b.Hb;f==q&&(f=a.response);d.parse(b,c,f,e)}.bind(this),100)};Ue.prototype.complete=function(a){Ve(this,1);setTimeout(function(){var b=a.s,c=a.Z;b.p.e=r;b.e=o;c.o();this.mc.set(b.na,o)}.bind(this),100)};Ue.prototype.Pf=function(a,b,c){i(Error("Loading failed: ",b,c))};
var Xe={STL:[He,q],VTK:[Ke,q],TRK:[Qe,q],FSM:[Me,q],INFLATED:[Me,q],SMOOTHWM:[Me,q],SPHERE:[Me,q],PIAL:[Me,q],ORIG:[Me,q],NRRD:[Se,q],NII:[Te,q],GZ:[Te,q],DCM:[Je,q],DICOM:[Je,q],"":[Je,q],CRV:[Pe,q],LABEL:[Oe,q],MGH:[Ne,r],MGZ:[Ne,o],TXT:[Re,q],LUT:[Re,q],PNG:[ye,"png"],JPG:[ye,"jpeg"],JPEG:[ye,"jpeg"],GIF:[ye,"gif"]};function Ye(a){function b(a,b,d){b=2*b*Math.PI;b=l.Db(Math.cos(b)).wc(k.Db(Math.sin(b)));a=c.wc(e.Db(a)).wc(b.Db(f));d=b.Db(1-Math.abs(d)).wc(g.Db(d));return new Fc(a,d)}this.A=[];for(var a=a||{},c=new va(a.start||[0,-1,0]),d=new va(a.end||[0,1,0]),e=d.cd(c),f=a.Wa||1,a=a.ff||16,g=e.ld(),h=0.5<Math.abs(g.y()),l=(new va(h,!h,0)).Ee(g).ld(),k=l.Ee(g).ld(),h=new Fc(c,g.Ve()),d=new Fc(d,g.ld()),j=[],n=0;n<a;n++){var s=n/a,p=(n+1)/a;j.push(new Hc([h,b(0,s,-1),b(0,p,-1)]));j.push(new Hc([b(0,p,0),b(0,s,
0),b(1,s,0),b(1,p,0)]));j.push(new Hc([d,b(1,p,1),b(1,s,1)]))}return Kc(j)}H(Ye,Jc);function Ze(){V.call(this);this.c="cylinder";this.ve=[-10,-10,-10];this.ee=[10,10,10];this.Sb=10;this.Vb=32;wa(this,new td)}H(Ze,V);Ze.prototype.__defineGetter__("start",t("ve"));Ze.prototype.__defineSetter__("start",function(a){(!y(a)||!C(a)||3!=a.length)&&i(Error("Invalid start"));this.ve=a});Ze.prototype.__defineGetter__("end",t("ee"));Ze.prototype.__defineSetter__("end",function(a){(!y(a)||!C(a)||3!=a.length)&&i(Error("Invalid end"));this.ee=a});Ze.prototype.__defineGetter__("radius",t("Sb"));
Ze.prototype.__defineSetter__("radius",function(a){D(a)||i(Error("Invalid radius."));this.Sb=a});Ze.prototype.o=function(){vd(this,new Ye({start:this.ve,end:this.ee,Wa:this.Sb,ff:this.Vb}));Ze.k.o.call(this)};E("X.cylinder",Ze);E("X.cylinder.prototype.modified",Ze.prototype.o);function $e(a){function b(a,b){var a=a*2*Math.PI,b=b*Math.PI,e=new va(Math.cos(a)*Math.sin(b),Math.cos(b),Math.sin(a)*Math.sin(b));g.push(new Fc(c.wc(e.Db(d)),e))}this.A=[];for(var a=a||{},c=new va(a.Ae||[0,0,0]),d=a.Wa||1,e=a.ff||16,a=a.Ii||8,f=[],g=[],h=0;h<e;h++)for(var l=0;l<a;l++)g=[],b(h/e,l/a),0<l&&b((h+1)/e,l/a),l<a-1&&b((h+1)/e,(l+1)/a),b(h/e,(l+1)/a),f.push(new Hc(g));return Kc(f)}H($e,Jc);function af(){V.call(this);this.c="sphere";this.l=[0,0,0];this.Sb=5;this.Vb=32;this.Sg=16;wa(this,new td)}H(af,V);af.prototype.__defineGetter__("center",t("l"));af.prototype.__defineSetter__("center",function(a){(!y(a)||!C(a)||3!=a.length)&&i(Error("Invalid center"));this.l=a});af.prototype.__defineGetter__("radius",t("Sb"));af.prototype.__defineSetter__("radius",function(a){D(a)||i(Error("Invalid radius."));this.Sb=a});
af.prototype.o=function(){vd(this,new $e({Ae:this.l,Wa:this.Sb,ff:this.Vb,Ii:this.Sg}));af.k.o.call(this)};E("X.sphere",af);E("X.sphere.prototype.modified",af.prototype.o);function Ge(a){P.call(this);this.c="labelmap";this.bb=a}H(Ge,P);Ge.prototype.o=function(){var a=new rd;a.Z=this;this.dispatchEvent(a);this.bb.o()};E("X.labelmap",Ge);function bf(a){this.A=[];var a=a||{},b=new va(a.Ae||[0,0,0]),c=!a.Wa?[1,1,1]:a.Wa.length?a.Wa:[a.Wa,a.Wa,a.Wa];return Kc([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(a){return new Hc(a[0].map(function(e){e=new va(b.x()+c[0]*(2*!!(e&1)-1),b.y()+c[1]*(2*!!(e&2)-1),b.b()+c[2]*(2*!!(e&4)-1));return new Fc(e,new va(a[1]))}))}))}H(bf,Jc);function cf(){V.call(this);this.c="cube";this.l=[0,0,0];this.le=this.ke=this.je=20;this.Wb=[0,1,1,1,1,0,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,1,1,1,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0];wa(this,new td)}H(cf,V);cf.prototype.__defineGetter__("center",t("l"));cf.prototype.__defineSetter__("center",function(a){(!y(a)||!C(a)||3!=a.length)&&i(Error("Invalid center"));this.l=a});cf.prototype.__defineGetter__("lengthX",t("je"));
cf.prototype.__defineSetter__("lengthX",function(a){D(a)||i(Error("Invalid lengthX."));this.je=a});cf.prototype.__defineGetter__("lengthY",t("ke"));cf.prototype.__defineSetter__("lengthY",function(a){D(a)||i(Error("Invalid lengthY."));this.ke=a});cf.prototype.__defineGetter__("lengthZ",t("le"));cf.prototype.__defineSetter__("lengthZ",function(a){D(a)||i(Error("Invalid lengthZ."));this.le=a});cf.prototype.o=function(){vd(this,new bf({Ae:this.l,Wa:[this.je/2,this.ke/2,this.le/2]}));cf.k.o.call(this)};
E("X.cube",cf);E("X.cube.prototype.modified",cf.prototype.o);function df(a){me.call(this,a);this.c="interactor3D"}H(df,me);df.prototype.dd=function(a){df.k.dd.call(this,a);var b=new Kd;y(a.sc)||(a.sc=0);b.Kb=0>a.sc;b.jb=o;this.dispatchEvent(b)};function ef(a){O.call(this);this.c="array";this.t=[];this.rf=a}H(ef,O);ef.prototype.add=function(a){this.t.push(a);return o};ef.prototype.clear=function(){this.t.length=0};function ff(a,b,c){var d=c-b;if(!(2>d)){d=b+Math.floor(d/2);ff(a,b,d);for(ff(a,d,c);b<d;++b)if(0<a.rf(a.t[b],a.t[d])){var e=a.t[b];a.t[b]=a.t[d];for(var f=a,g=d,h=c;g+1<h&&0>f.rf(f.t[g+1],e);){var l=f,k=g+1,j=l.t[g];l.t[g]=l.t[k];l.t[k]=j;++g}f.t[g]=e}}}ef.prototype.sort=function(){ff(this,0,this.t.length)};function gf(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}gf.prototype.f=function(){return new gf(this.top,this.right,this.bottom,this.left)};gf.prototype.contains=function(a){return!this||!a?r:a instanceof gf?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom};function hf(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}hf.prototype.f=function(){return new hf(this.left,this.top,this.width,this.height)};hf.prototype.$f=function(a){var b=Math.max(this.left,a.left),c=Math.min(this.left+this.width,a.left+a.width);if(b<=c){var d=Math.max(this.top,a.top),a=Math.min(this.top+this.height,a.top+a.height);if(d<=a)return this.left=b,this.top=d,this.width=c-b,this.height=a-d,o}return r};
hf.prototype.contains=function(a){return a instanceof hf?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};hf.prototype.sa=function(){return new Wc(this.width,this.height)};function jf(a,b){var c=$d(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,q))?c[b]||c.getPropertyValue(b):""}function kf(a,b){return a.currentStyle?a.currentStyle[b]:q}function lf(a,b){return jf(a,b)||kf(a,b)||a.style&&a.style[b]}function mf(a){a=a?9==a.nodeType?a:$d(a):document;return L&&!kb(9)&&!ke(Xd(a))?a.body:a.documentElement}
function nf(a){var b=a.getBoundingClientRect();L&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function of(a){if(L&&!kb(8))return a.offsetParent;for(var b=$d(a),c=lf(a,"position"),d="fixed"==c||"absolute"==c,a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=lf(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return q}
function pf(a){for(var b=new gf(0,Infinity,Infinity,0),c=Xd(a),d=c.N.body,e=c.N.documentElement,f=!Ua&&"CSS1Compat"==c.N.compatMode?c.N.documentElement:c.N.body;a=of(a);)if((!L||0!=a.clientWidth)&&(!Ua||0!=a.clientHeight||a!=d)&&a!=d&&a!=e&&"visible"!=lf(a,"overflow")){var g=qf(a),h;h=a;if(Ta&&!hb("1.9")){var l=parseFloat(jf(h,"borderLeftWidth"));if(rf(h))var k=h.offsetWidth-h.clientWidth-l-parseFloat(jf(h,"borderRightWidth")),l=l+k;h=new Tc(l,parseFloat(jf(h,"borderTopWidth")))}else h=new Tc(h.clientLeft,
h.clientTop);g.x+=h.x;g.y+=h.y;b.top=Math.max(b.top,g.y);b.right=Math.min(b.right,g.x+a.clientWidth);b.bottom=Math.min(b.bottom,g.y+a.clientHeight);b.left=Math.max(b.left,g.x)}d=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,d);b.top=Math.max(b.top,f);c=c.N.parentWindow||c.N.defaultView||window;e=c.document;Ua&&!hb("500")&&!Va?("undefined"==typeof c.innerHeight&&(c=window),e=c.innerHeight,a=c.document.documentElement.scrollHeight,c==c.top&&a<e&&(e-=15),c=new Wc(c.innerWidth,e)):(c="CSS1Compat"==
e.compatMode?e.documentElement:e.body,c=new Wc(c.clientWidth,c.clientHeight));b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?b:q}
function qf(a){var b,c=$d(a),d=lf(a,"position"),e=Ta&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new Tc(0,0),g=mf(c);if(a==g)return f;if(a.getBoundingClientRect)b=nf(a),a=le(Xd(c)),f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);
if(Ua&&"fixed"==lf(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(Sa||Ua&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=of(b))&&b!=c.body&&b!=g;)if(f.x-=b.scrollLeft,!Sa||"TR"!=b.tagName)f.y-=b.scrollTop}return f}function sf(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}
function tf(a){if("none"!=lf(a,"display"))return uf(a);var b=a.style,c=b.display,d=b.visibility,e=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";a=uf(a);b.display=c;b.position=e;b.visibility=d;return a}function uf(a){var b=a.offsetWidth,c=a.offsetHeight,d=Ua&&!b&&!c;return(!fa(b)||d)&&a.getBoundingClientRect?(a=nf(a),new Wc(a.right-a.left,a.bottom-a.top)):new Wc(b,c)}function vf(a,b){a.style.display=b?"":"none"}function rf(a){return"rtl"==lf(a,"direction")}
function wf(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,d=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var e=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=d;return e}var xf={thin:2,medium:4,thick:6};function yf(a,b){if("none"==kf(a,b+"Style"))return 0;var c=kf(a,b+"Width");return c in xf?xf[c]:wf(a,c)};function zf(a){this.Ma=a;this.v=[]}H(zf,Tb);var Af=[];function Bf(a,b,c,d,e){C(c)||(Af[0]=c,c=Af);for(var f=0;f<c.length;f++)a.v.push(M(b,c[f],d||a,e||r,a.Ma||a))}zf.prototype.Yd=function(){ub(this.v,sc);this.v.length=0};zf.prototype.M=function(){zf.k.M.call(this);this.Yd()};zf.prototype.handleEvent=function(){i(Error("EventHandler.handleEvent not implemented"))};function Cf(){}(function(a){a.Qf=function(){return a.wh||(a.wh=new a)}})(Cf);Cf.prototype.We=0;Cf.Qf();function Df(a){this.Sa=a||Xd()}H(Df,Ec);u=Df.prototype;u.uh=Cf.Qf();u.Xf=q;u.cc=r;u.q=q;u.vc=q;u.Id=q;u.Tc=q;u.Ri=r;u.i=t("q");u.df=function(a){this.vc&&this.vc!=a&&i(Error("Method not supported"));Df.k.df.call(this,a)};u.Md=t("Sa");u.qc=function(){this.q=this.Sa.createElement("div")};u.fc=function(a){this.eb(a)};u.eb=function(a,b){this.cc&&i(Error("Component already rendered"));this.q||this.qc();a?a.insertBefore(this.q,b||q):this.Sa.N.body.appendChild(this.q);(!this.vc||this.vc.cc)&&this.Ld()};
u.Ld=function(){this.cc=o;Ef(this,function(a){!a.cc&&a.i()&&a.Ld()})};u.Xc=function(){Ef(this,function(a){a.cc&&a.Xc()});this.Qd&&this.Qd.Yd();this.cc=r};u.M=function(){Df.k.M.call(this);this.cc&&this.Xc();this.Qd&&(this.Qd.Ja(),delete this.Qd);Ef(this,function(a){a.Ja()});!this.Ri&&this.q&&he(this.q);this.vc=this.q=this.Tc=this.Id=q};function Ef(a,b){a.Id&&ub(a.Id,b,m)}
u.removeChild=function(a,b){if(a){var c=ia(a)?a:a.Xf||(a.Xf=":"+(a.uh.We++).toString(36)),a=this.Tc&&c?(c in this.Tc?this.Tc[c]:m)||q:q;if(c&&a){var d=this.Tc;c in d&&delete d[c];yb(this.Id,a);b&&(a.Xc(),a.q&&he(a.q));c=a;c==q&&i(Error("Unable to set parent component"));c.vc=q;Df.k.df.call(c,q)}}a||i(Error("Child is not in parent component"));return a};function Ff(){}H(Ff,Ec);u=Ff.prototype;u.nf=0;u.bd=0;u.Re=100;u.Of=0;u.jf=1;u.Dh=r;u.Hh=r;u.ae=function(a){a=Gf(this,a);this.nf!=a&&(this.nf=a+this.Of>this.Re?this.Re-this.Of:a<this.bd?this.bd:a,!this.Dh&&!this.Hh&&this.dispatchEvent("change"))};u.Pd=function(){return Gf(this,this.nf)};u.Od=function(){return Gf(this,this.bd)};u.Nd=function(){return Gf(this,this.Re)};function Gf(a,b){return a.jf==q?b:a.bd+Math.round((b-a.bd)/a.jf)*a.jf};function Hf(a){this.Sa=a||Xd();this.xc=new Ff;M(this.xc,"change",this.rh,r,this)}H(Hf,Df);var If={vertical:"progress-bar-vertical",horizontal:"progress-bar-horizontal"};u=Hf.prototype;u.qc=function(){this.Pa=this.Md().qc("div","progress-bar-thumb");var a=If[this.og];this.q=this.Md().qc("div",a,this.Pa);Jf(this);this.i().setAttribute("aria-valuemin",this.Od());this.i().setAttribute("aria-valuemax",this.Nd())};
u.Ld=function(){Hf.k.Ld.call(this);L&&7>Za&&M(this.i(),"resize",this.ce,r,this);this.ce();var a=this.i();a.setAttribute("role","progressbar");a.Lj="progressbar";this.i().setAttribute("aria-live","polite")};u.Xc=function(){Hf.k.Xc.call(this);Kf(this)};function Kf(a){L&&7>Za&&rc(a.i(),"resize",a.ce,r,a)}u.Pd=function(){return this.xc.Pd()};u.ae=function(a){this.xc.ae(a);this.i()&&Jf(this)};function Jf(a){var b=a.Pd();a.i().setAttribute("aria-valuenow",b)}u.Od=function(){return this.xc.Od()};u.Nd=function(){return this.xc.Nd()};
u.og="horizontal";u.rh=function(){this.ce();this.dispatchEvent("change")};u.ce=function(){if(this.Pa){var a=this.Od(),b=this.Nd(),a=(this.Pd()-a)/(b-a),b=Math.round(100*a);"vertical"==this.og?L&&7>Za?(this.Pa.style.top=0,this.Pa.style.height="100%",b=this.Pa.offsetHeight,a=Math.round(a*b),this.Pa.style.top=b-a+"px",this.Pa.style.height=a+"px"):(this.Pa.style.top=100-b+"%",this.Pa.style.height=b+"%"):this.Pa.style.width=b+"%"}};u.M=function(){Kf(this);Hf.k.M.call(this);this.Pa=q;this.xc.Ja()};function Lf(a,b){y(a)||i(Error("No valid parent element."));y(b)||i(Error("Invalid initial value."));Hf.call(this);this.c="progressbar";this.Ba=a;this.qd=this.ab=q;this.Gb=[];this.Gb=[".progress-bar-horizontal {\n  position: relative;\n  border: 1px solid #949dad;\n  background: white;\n  padding: 1px;\n  overflow: hidden;\n  margin: 2px;\n  width: 100px;\n  height: 5px;\n}",".progress-bar-thumb {\n  position: relative;\n  background: #F62217;\n  overflow: hidden;\n  width: 0%;\n  height: 100%;\n}",
".progress-bar-thumb-done {\n  background: #57E964;\n}"];this.ae(b);this.Ne()}H(Lf,Hf);
Lf.prototype.Ne=function(){if("static"==this.Ba.style.position||""==this.Ba.style.position)this.Ba.style.position="relative";var a=document.getElementsByTagName("head")[0],b=de("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.Gb[0]),d=document.createTextNode(this.Gb[1]),e=document.createTextNode(this.Gb[2]);a.appendChild(b);b.appendChild(c);b.appendChild(d);b.appendChild(e);this.ab=b;this.fc(this.Ba);a=this.i();a.style.position="absolute";a.style.top=(this.Ba.clientHeight-
5)/2+"px";a.style.left=(this.Ba.clientWidth-100)/2+"px";a.classList.add("xtk-progress-bar")};function Mf(a){var b=a.i().style.top,c=a.i().style.left;he(a.i());var d=new Lf(a.Ba,100),e=d.i();e.style.position="absolute";e.style.top=b;e.style.left=c;e.classList.add("xtk-progress-bar");(e.firstElementChild!=m?e.firstElementChild:ie(e.firstChild)).classList.add("progress-bar-thumb-done");a.qd=d}
Lf.prototype.Sd=function(){this.ab&&he(this.ab);this.i()&&he(this.i());this.qd&&he(this.qd.i());this.qd=this.ab=q};var Nf=ca.window;function Of(a,b,c){ja(a)?c&&(a=qa(a,c)):a&&"function"==typeof a.handleEvent?a=qa(a.handleEvent,a):i(Error("Invalid listener argument"));return 2147483647<b?-1:Nf.setTimeout(a,b||0)};function Pf(){O.call(this);this.c="renderer";this.s=window.document.body;this.K=this.s.clientWidth;this.H=this.s.clientHeight;this.xd=this.wd=0;this.Lb=this.u=this.za=q;this.Za=new ef(sd);this.Ra=[];this.B=q;this.qe=this.td=this.ud=r;this.a=this.ka=q;this.U={PROGRESSBAR_ENABLED:o};this.pf=-1;window.console.log("XTK release 9 -- 2012-10-26 13:16:48 -- http://www.goXTK.com -- @goXTK")}H(Pf,O);u=Pf.prototype;u.Xh=function(a){this.ka&&this.ka.ae(100*a.Df)};u.Mh=function(a){y(a)&&a instanceof rd&&a.Z&&this.Xa(a.Z)};
u.Ze=function(a){(!y(a)||!(a instanceof Md))&&i(Error("Invalid hover event."))};u.Vh=function(a){(!y(a)||!(a instanceof Od))&&i(Error("Invalid paint event."));this.wd=a.Yb;this.xd=a.Zb;this.eb(r,r)};u.Yh=aa();u.$e=function(a){(!y(a)||!(a instanceof Ld))&&i(Error("Invalid scroll event."))};Pf.prototype.__defineGetter__("config",t("U"));Pf.prototype.__defineGetter__("interactor",t("Lb"));Pf.prototype.__defineGetter__("camera",t("u"));Pf.prototype.__defineGetter__("loadingCompleted",t("td"));
Pf.prototype.__defineGetter__("container",t("s"));Pf.prototype.__defineSetter__("container",function(a){y(a)||i(Error("An ID to a valid container (<div>..) is required."));var b=a;ia(b)&&(b=ae(a));ka(b)&&1==b.nodeType||i(Error("Could not find the given container."));this.s=b});u=Pf.prototype;u.gd=function(){this.u.reset()};function Qf(a){a.U.PROGRESSBAR_ENABLED&&a.ka&&!a.qf&&(Mf(a.ka),a.qf=Of(function(){this.qf=q;this.ka&&(this.ka.Sd(),this.ka=q);this.fc()}.bind(a),700))}
u.ja=function(a){var b=de("canvas");this.s.appendChild(b);this.K=this.s.clientWidth;this.H=this.s.clientHeight;b.width=this.K;b.height=this.H;try{var c=b.getContext(a);c||i(Error())}catch(d){var e="Sorry, "+a+' context is <strong>not supported</strong> on this machine! See <a href="http://crash.goXTK.com" target="_blank">http://crash.goXTK.com</a> for requirements..';this.s.innerHTML='<h3 style="color:red;font-family:sans-serif;">Oooops..</h3><p style="color:red;font-family:sans-serif;">'+e+"</p>";
i(Error(e))}this.B=new Ue;M(this.B,Dd,this.Xh.bind(this));this.za=b;this.a=c;b=new df(this.za);"2d"==a&&(b=new pe(this.za));b.ja();M(b,Bd,this.gd.bind(this));M(b,Ed,this.Ze.bind(this));M(b,Ad,this.$e.bind(this));M(b,Gd,this.Vh.bind(this));this.Lb=b;b=new re(this.K,this.H);"2d"==a&&(b=new ze(this.K,this.H));a=b;c=this.Lb;(!y(c)||!(c instanceof me))&&i(Error("Could not observe the interactor."));M(c,yd,a.Zh.bind(a));M(c,xd,a.Wh.bind(a));M(c,zd,a.ci.bind(a));this.u=b;M(window,"resize",this.Yh,r,this)};
u.add=function(a){(a instanceof cf||a instanceof af||a instanceof Ze)&&a.o();this.Ra.push(a);this.Xa(a)};u.Xa=function(a){(!this.za||!this.a)&&i(Error("The renderer was not initialized properly."));y(a)||(window.console.log(a),i(Error("Illegal object.")));vc(a)||M(a,wc,this.Mh.bind(this))};u.get=function(a){y(a)||i(Error("Invalid object id."));for(var b=this.Za.t,c=b.length,d=0,d=0;d<c;d++)if(b[d].na==a)return b[d];return q};
u.fc=function(){(!this.za||!this.a)&&i(Error("The renderer was not initialized properly."));y(this.Bf)||(this.B.mc.Ce(r)?(this.U.PROGRESSBAR_ENABLED&&!this.ka&&(this.ka=new Lf(this.s,3)),this.qe=this.td=r,this.Bf=Of(function(){this.Bf=q;this.fc()}.bind(this),100)):(!this.td&&!this.qe&&(this.qe=o,eval("this.onShowtime()"),this.td=o),this.ka?Qf(this):(this.pf=window.fd(this.fc.bind(this),this.za),eval("this.onRender()"),this.eb(r,o))))};u.ng=aa();u.lg=aa();u.eb=aa();
u.Kd=function(){window.Hd(this.pf);this.B&&(delete this.B,this.B=q);this.ka&&(this.ka.Sd(),delete this.ka,this.ka=q);this.Za.clear();delete this.Za;this.Ra.length=0;delete this.Ra;delete this.B;this.B=q;delete this.u;this.u=q;delete this.Lb;this.Lb=q;delete this.a;this.a=q;he(this.za);delete this.za;this.za=q};function Rf(a,b,c,d,e,f,g,h){var l,k=c.offsetParent;if(k){var j="HTML"==k.tagName||"BODY"==k.tagName;if(!j||"static"!=lf(k,"position"))l=qf(k),j||(l=Uc(l,new Tc(k.scrollLeft,k.scrollTop)))}k=qf(a);j=tf(a);k=new hf(k.x,k.y,j.width,j.height);(j=pf(a))&&k.$f(new hf(j.left,j.top,j.right-j.left,j.bottom-j.top));var j=Xd(a),n=Xd(c);if(j.N!=n.N){var s=j.N.body,n=n.N.parentWindow||n.N.defaultView,p=new Tc(0,0),w=$d(s)?$d(s).parentWindow||$d(s).defaultView:window,v=s;do{var z;if(w==n)z=qf(v);else{var B=v;
z=new Tc;if(1==B.nodeType)if(B.getBoundingClientRect)B=nf(B),z.x=B.left,z.y=B.top;else{var x=le(Xd(B)),B=qf(B);z.x=B.x-x.x;z.y=B.y-x.y}else{var x=ja(B.oh),A=B;B.targetTouches?A=B.targetTouches[0]:x&&B.Ta.targetTouches&&(A=B.Ta.targetTouches[0]);z.x=A.clientX;z.y=A.clientY}}p.x+=z.x;p.y+=z.y}while(w&&w!=n&&(v=w.frameElement)&&(w=w.parent));s=Uc(p,qf(s));L&&!ke(j)&&(s=Uc(s,le(j)));k.left+=s.x;k.top+=s.y}a=(b&4&&rf(a)?b^2:b)&-5;b=new Tc(a&2?k.left+k.width:k.left,a&1?k.top+k.height:k.top);l&&(b=Uc(b,
l));e&&(b.x+=(a&2?-1:1)*e.x,b.y+=(a&1?-1:1)*e.y);var F;if(g&&(F=pf(c))&&l)F.top-=l.y,F.right-=l.x,F.bottom-=l.y,F.left-=l.x;return Sf(b,c,d,f,F,g,h)}
function Sf(a,b,c,d,e,f,g){var a=a.f(),h=0,l=(c&4&&rf(b)?c^2:c)&-5,c=tf(b),g=g?g.f():c.f();if(d||0!=l)l&2?a.x-=g.width+(d?d.right:0):d&&(a.x+=d.left),l&1?a.y-=g.height+(d?d.bottom:0):d&&(a.y+=d.top);if(f){if(e){h=a;d=0;if(65==(f&65)&&(h.x<e.left||h.x>=e.right))f&=-2;if(132==(f&132)&&(h.y<e.top||h.y>=e.bottom))f&=-5;h.x<e.left&&f&1&&(h.x=e.left,d|=1);h.x<e.left&&h.x+g.width>e.right&&f&16&&(g.width=Math.max(g.width-(h.x+g.width-e.right),0),d|=4);h.x+g.width>e.right&&f&1&&(h.x=Math.max(e.right-g.width,
e.left),d|=1);f&2&&(d|=(h.x<e.left?16:0)|(h.x+g.width>e.right?32:0));h.y<e.top&&f&4&&(h.y=e.top,d|=2);h.y>=e.top&&h.y+g.height>e.bottom&&f&32&&(g.height=Math.max(g.height-(h.y+g.height-e.bottom),0),d|=8);h.y+g.height>e.bottom&&f&4&&(h.y=Math.max(e.bottom-g.height,e.top),d|=2);f&8&&(d|=(h.y<e.top?64:0)|(h.y+g.height>e.bottom?128:0));h=d}else h=256;if(h&496)return h}f=a;e=Ta&&(La||Ya)&&hb("1.9");f instanceof Tc?(a=f.x,f=f.y):(a=f,f=m);b.style.left=sf(a,e);b.style.top=sf(f,e);Xc(c,g)||(a=ke(Xd($d(b))),
L&&(!a||!hb("8"))?(c=b.style,a?(L?(a=wf(b,kf(b,"paddingLeft")),e=wf(b,kf(b,"paddingRight")),f=wf(b,kf(b,"paddingTop")),d=wf(b,kf(b,"paddingBottom")),a=new gf(f,e,d,a)):(a=jf(b,"paddingLeft"),e=jf(b,"paddingRight"),f=jf(b,"paddingTop"),d=jf(b,"paddingBottom"),a=new gf(parseFloat(f),parseFloat(e),parseFloat(d),parseFloat(a))),L?(e=yf(b,"borderLeft"),f=yf(b,"borderRight"),d=yf(b,"borderTop"),b=yf(b,"borderBottom"),b=new gf(d,f,b,e)):(e=jf(b,"borderLeftWidth"),f=jf(b,"borderRightWidth"),d=jf(b,"borderTopWidth"),
b=jf(b,"borderBottomWidth"),b=new gf(parseFloat(d),parseFloat(f),parseFloat(b),parseFloat(e))),c.pixelWidth=g.width-b.left-a.left-a.right-b.right,c.pixelHeight=g.height-b.top-a.top-a.bottom-b.bottom):(c.pixelWidth=g.width,c.pixelHeight=g.height)):(b=b.style,Ta?b.MozBoxSizing="border-box":Ua?b.WebkitBoxSizing="border-box":b.boxSizing="border-box",b.width=Math.max(g.width,0)+"px",b.height=Math.max(g.height,0)+"px"));return h};function Tf(){}Tf.prototype.Oa=aa();function Uf(a,b){this.element=a;this.If=b}H(Uf,Tf);Uf.prototype.Oa=function(a,b,c){Rf(this.element,this.If,a,b,m,c)};function Vf(a,b){this.Ma=new zf(this);this.cf(a||q);b&&(this.Ac=b)}H(Vf,Ec);u=Vf.prototype;u.q=q;u.Tg=o;u.Ef=q;u.ma=r;u.zi=r;u.Qe=-1;u.th=r;u.hh=o;u.Ac="toggle_display";u.i=t("q");u.cf=function(a){this.ma&&i(Error("Can not change this state of the popup while showing."));this.q=a};
function Wf(a,b){a.jd&&a.jd.stop();a.$c&&a.$c.stop();if(b){if(!a.ma&&a.Xe()){a.q||i(Error("Caller must call setElement before trying to show the popup"));a.Oa();var c=$d(a.q);a.th&&Bf(a.Ma,c,"keydown",a.Kh,o);if(a.Tg)if(Bf(a.Ma,c,"mousedown",a.jg,o),L){var d;try{d=c.activeElement}catch(e){}for(;d&&"IFRAME"==d.nodeName;){try{var f=d.contentDocument||d.contentWindow.document}catch(g){break}c=f;d=c.activeElement}Bf(a.Ma,c,"mousedown",a.jg,o);Bf(a.Ma,c,"deactivate",a.ig)}else Bf(a.Ma,c,"blur",a.ig);"toggle_display"==
a.Ac?(a.q.style.visibility="visible",vf(a.q,o)):"move_offscreen"==a.Ac&&a.Oa();a.ma=o;a.jd?(qc(a.jd,"end",a.mg,r,a),a.jd.play()):a.mg()}}else Xf(a)}u.Oa=da;function Xf(a,b){if(!a.ma||!a.dispatchEvent({type:"beforehide",target:b}))return r;a.Ma&&a.Ma.Yd();a.$c?(qc(a.$c,"end",ra(a.Hf,b),r,a),a.$c.play()):a.Hf(b);return o}u.Hf=function(a){"toggle_display"==this.Ac?this.zi?Of(this.Wf,0,this):this.Wf():"move_offscreen"==this.Ac&&(this.q.style.left="-200px",this.q.style.top="-200px");this.ma=r;this.Ye(a)};
u.Wf=function(){this.q.style.visibility="hidden";vf(this.q,r)};u.Xe=function(){return this.dispatchEvent("beforeshow")};u.mg=function(){this.Qe=ua();this.dispatchEvent("show")};u.Ye=function(a){ua();this.dispatchEvent({type:"hide",target:a})};u.jg=function(a){a=a.target;!je(this.q,a)&&(!this.Ef||je(this.Ef,a))&&!(150>ua()-this.Qe)&&Xf(this,a)};u.Kh=function(a){27==a.keyCode&&Xf(this,a.target)&&(a.preventDefault(),a.stopPropagation())};
u.ig=function(a){if(this.hh){var b=$d(this.q);if(L||Sa){if(a=b.activeElement,!a||je(this.q,a)||"BODY"==a.tagName)return}else if(a.target!=b)return;150>ua()-this.Qe||Xf(this)}};u.M=function(){Vf.k.M.call(this);this.Ma.Ja();Vb(this.jd);Vb(this.$c);delete this.q;delete this.Ma};function Yf(a,b){this.De=a instanceof Tc?a:new Tc(a,b)}H(Yf,Tf);Yf.prototype.Oa=function(a,b,c,d){Rf(mf(a),0,a,b,this.De,c,q,d)};function Zf(a,b){this.ei=4;this.Xd=b||m;Vf.call(this,a)}H(Zf,Vf);Zf.prototype.Oa=function(){if(this.Xd){var a=!this.ma&&"move_offscreen"!=this.Ac,b=this.i();a&&(b.style.visibility="hidden",vf(b,o));this.Xd.Oa(b,this.ei,this.Jj);a&&vf(b,r)}};function $f(a,b,c){this.Sa=c||(a?Xd(ae(a)):Xd());Zf.call(this,this.Sa.qc("div",{style:"position:absolute;display:none;"}));this.Fe=new Tc(1,1);this.ac=new Qb;a&&ag(this,a);if(b!=q)if(a=this.i(),"textContent"in a)a.textContent=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(;c=a.firstChild;)a.removeChild(c);a.appendChild($d(a).createTextNode(b))}}H($f,Zf);var bg=[];u=$f.prototype;u.la=q;u.className="goog-tooltip";
u.ug=500;u.sh=0;u.Md=t("Sa");function ag(a,b){b=ae(b);a.ac.add(b);M(b,"mouseover",a.Tf,r,a);M(b,"mouseout",a.Rd,r,a);M(b,"mousemove",a.Sf,r,a);M(b,"focus",a.Rf,r,a);M(b,"blur",a.Rd,r,a)}u.detach=function(a){if(a)a=ae(a),cg(this,a),this.ac.remove(a);else{for(var b=this.ac.La(),c=0;a=b[c];c++)cg(this,a);this.ac.clear()}};function cg(a,b){rc(b,"mouseover",a.Tf,r,a);rc(b,"mouseout",a.Rd,r,a);rc(b,"mousemove",a.Sf,r,a);rc(b,"focus",a.Rf,r,a);rc(b,"blur",a.Rd,r,a)}
u.cf=function(a){var b=this.i();b&&he(b);$f.k.cf.call(this,a);a&&(b=this.Sa.N.body,b.insertBefore(a,b.lastChild))};u.Xe=function(){if(!Vf.prototype.Xe.call(this))return r;if(this.anchor)for(var a,b=0;a=bg[b];b++)je(a.i(),this.anchor)||Wf(a,r);0<=tb(bg,this)||bg.push(this);a=this.i();a.className=this.className;dg(this);M(a,"mouseover",this.Vf,r,this);M(a,"mouseout",this.Uf,r,this);eg(this);return o};
u.Ye=function(){yb(bg,this);for(var a=this.i(),b,c=0;b=bg[c];c++)b.anchor&&je(a,b.anchor)&&Wf(b,r);this.qg&&fg(this.qg);rc(a,"mouseover",this.Vf,r,this);rc(a,"mouseout",this.Uf,r,this);this.anchor=m;if(0==(this.fb?this.ma?4:1:this.uc?3:this.ma?2:0))this.Zd=r;Vf.prototype.Ye.call(this)};u.gg=function(a,b){this.anchor==a&&this.ac.contains(this.anchor)&&(this.Zd||!this.Kj?(Wf(this,r),this.ma||(this.anchor=a,this.Xd=b||gg(this,0)||m,this.ma&&this.Oa(),Wf(this,o))):this.anchor=m);this.fb=m};
u.Gh=function(a){this.uc=m;a==this.anchor&&(this.la==q||this.la!=this.i()&&!this.ac.contains(this.la))&&(!this.Ff||!this.Ff.la)&&Wf(this,r)};function hg(a,b){var c=le(a.Sa);a.Fe.x=b.clientX+c.x;a.Fe.y=b.clientY+c.y}u.Tf=function(a){var b=ig(this,a.target);this.la=b;dg(this);b!=this.anchor&&(this.anchor=b,this.fb||(this.fb=Of(qa(this.gg,this,b,m),this.ug)),jg(this),hg(this,a))};function ig(a,b){try{for(;b&&!a.ac.contains(b);)b=b.parentNode;return b}catch(c){return q}}
u.Sf=function(a){hg(this,a);this.Zd=o};u.Rf=function(a){this.la=a=ig(this,a.target);this.Zd=o;if(this.anchor!=a){this.anchor=a;var b=gg(this,1);dg(this);this.fb||(this.fb=Of(qa(this.gg,this,a,b),this.ug));jg(this)}};function gg(a,b){if(0==b){var c=a.Fe.f();return new kg(c)}return new lg(a.la)}function jg(a){if(a.anchor)for(var b,c=0;b=bg[c];c++)je(b.i(),a.anchor)&&(b.Ff=a,a.qg=b)}
u.Rd=function(a){var b=ig(this,a.target),c=ig(this,a.relatedTarget);b!=c&&(b==this.la&&(this.la=q),eg(this),this.Zd=r,this.ma&&(!a.relatedTarget||!je(this.i(),a.relatedTarget))?fg(this):this.anchor=m)};u.Vf=function(){var a=this.i();this.la!=a&&(dg(this),this.la=a)};u.Uf=function(a){var b=this.i();if(this.la==b&&(!a.relatedTarget||!je(b,a.relatedTarget)))this.la=q,fg(this)};function eg(a){a.fb&&(Nf.clearTimeout(a.fb),a.fb=m)}
function fg(a){if(2==(a.fb?a.ma?4:1:a.uc?3:a.ma?2:0))a.uc=Of(qa(a.Gh,a,a.anchor),a.sh)}function dg(a){a.uc&&(Nf.clearTimeout(a.uc),a.uc=m)}u.M=function(){Wf(this,r);eg(this);this.detach();this.i()&&he(this.i());this.la=q;delete this.Sa;$f.k.M.call(this)};function kg(a,b){Yf.call(this,a,b)}H(kg,Yf);kg.prototype.Oa=function(a,b,c){b=mf(a);b=pf(b);c=c?new gf(c.top+10,c.right,c.bottom,c.left+10):new gf(10,0,0,10);Sf(this.De,a,4,c,b,9)&496&&Sf(this.De,a,4,c,b,5)};function lg(a){Uf.call(this,a,3)}
H(lg,Uf);lg.prototype.Oa=function(a,b,c){var d=new Tc(10,0);Rf(this.element,this.If,a,b,d,c,9)&496&&Rf(this.element,2,a,1,d,c,5)};function mg(a,b,c,d){y(a)||i(Error("No valid parent element."));(!D(b)||!D(c))&&i(Error("Invalid coordinates."));(!y(d)||!(d instanceof me))&&i(Error("Invalid interactor."));$f.call(this);this.c="caption";this.Ba=a;this.Yb=b;this.Zb=c;this.Lb=d;this.ab=q;this.Gb=[];this.Gb=[".x-tooltip {\n  background: #C0C0FF;\n  color: #000000;\n  border: 1px solid infotext;\n  padding: 1px;\n  font-family: sans-serif;\n}"];qc(d,Fd,this.Sd.bind(this));this.Ne()}H(mg,$f);
mg.prototype.Ne=function(){if("static"==this.Ba.style.position||""==this.Ba.style.position)this.Ba.style.position="relative";var a=document.getElementsByTagName("head")[0],b=de("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.Gb[0]);a.appendChild(b);b.appendChild(c);this.ab=b;this.Xd=new Yf(this.Yb,this.Zb)||m;this.ma&&this.Oa();Wf(this,o);ag(this,this.Ba);this.i().classList.add("x-tooltip")};
mg.prototype.Sd=function(){Wf(this,r);this.ab&&he(this.ab);this.i()&&he(this.i());this.ab=q};function ng(){Pf.call(this);this.c="renderer3D";this.Jc=this.Mc=this.Ic=this.Lc=this.Hc=this.Kc=this.re=this.se=q;this.l=[0,0,0];this.Af=q;this.de=new Mb;this.Pc=new Mb;this.Sc=new Mb;this.oe=new Mb;this.pd=new Mb;this.Ad=new Mb;this.Bd=new Mb;this.Cd=new Mb;this.U={PROGRESSBAR_ENABLED:o,PICKING_ENABLED:o,ORDERING_ENABLED:o,STATISTICS_ENABLED:r}}H(ng,Pf);ng.prototype.__defineGetter__("config",t("U"));u=ng.prototype;u.ni=function(){this.Jc=this.Mc=this.Ic=this.Lc=this.Hc=this.Kc=q;this.l=[0,0,0]};
u.Ze=function(a){ng.k.Ze.call(this,a);var b=a.Yb,a=a.Zb,c=this.get(this.rg(b,a));if(c&&(c=c.ic))(new mg(this.s,this.s.offsetLeft+b+10,this.s.offsetTop+a+10,this.Lb)).i().innerHTML=c};
u.ja=function(){ng.k.ja.call(this,"experimental-webgl");try{if(this.a.viewport(0,0,this.K,this.H),this.a.clearColor(0,0,0,0),this.a.enable(this.a.BLEND),this.a.blendEquation(this.a.FUNC_ADD),this.a.blendFunc(this.a.SRC_ALPHA,this.a.ONE_MINUS_SRC_ALPHA),this.a.enable(this.a.DEPTH_TEST),this.a.depthFunc(this.a.LEQUAL),this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT),this.U.PICKING_ENABLED){var a=this.a.createFramebuffer(),b=this.a.createRenderbuffer(),c=this.a.createTexture();this.a.bindTexture(this.a.TEXTURE_2D,
c);this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGB,this.K,this.H,0,this.a.RGB,this.a.UNSIGNED_BYTE,q);this.a.bindFramebuffer(this.a.FRAMEBUFFER,a);this.a.bindRenderbuffer(this.a.RENDERBUFFER,b);this.a.renderbufferStorage(this.a.RENDERBUFFER,this.a.DEPTH_COMPONENT16,this.K,this.H);this.a.bindRenderbuffer(this.a.RENDERBUFFER,q);this.a.framebufferTexture2D(this.a.FRAMEBUFFER,this.a.COLOR_ATTACHMENT0,this.a.TEXTURE_2D,c,0);this.a.framebufferRenderbuffer(this.a.FRAMEBUFFER,this.a.DEPTH_ATTACHMENT,this.a.RENDERBUFFER,
b);this.a.bindFramebuffer(this.a.FRAMEBUFFER,q);this.Af=a}}catch(d){i(Error("Exception while accessing GL Context!\n"+d))}og(this)};
function og(a){var b=new Ae;(!y(a.za)||!y(a.a)||!y(a.u))&&i(Error("Renderer was not initialized properly."));(!y(b)||!(b instanceof Ae))&&i(Error("Could not add shaders."));De(b);var c=a.a.createShader(a.a.FRAGMENT_SHADER),d=a.a.createShader(a.a.VERTEX_SHADER);a.a.shaderSource(c,b.rd);a.a.shaderSource(d,b.Dd);a.a.compileShader(c);a.a.compileShader(d);a.a.getShaderParameter(c,a.a.COMPILE_STATUS)||i(Error("Fragement Shader compilation failed!\n"+a.a.getShaderInfoLog(c)));a.a.getShaderParameter(d,a.a.COMPILE_STATUS)||
i(Error("Vertex Shader compilation failed!\n"+a.a.getShaderInfoLog(d)));var e=a.a.createProgram();a.a.attachShader(e,d);a.a.attachShader(e,c);a.a.linkProgram(e);a.a.getProgramParameter(e,a.a.LINK_STATUS)||i(Error("Could not create shader program!\n"+a.a.getShaderInfoLog(c)+"\n"+a.a.getShaderInfoLog(d)+"\n"+a.a.getProgramInfoLog(e)));a.a.useProgram(e);a.re=e;Object.keys(Be).forEach(function(a){a=Be[a];this.de.set(a,this.a.getAttribLocation(this.re,a));this.a.enableVertexAttribArray(this.de.get(a))}.bind(a));
Object.keys(Ce).forEach(function(a){a=Ce[a];this.Pc.set(a,this.a.getUniformLocation(this.re,a))}.bind(a));a.se=b}
u.Xa=function(a){ng.k.Xa.call(this,a);var b=r;this.get(a.na)&&(b=o);var c=a.na,d=a.g,e=a.h,f=a.T,g=a.z,h=a.p,l=a.Xb,k=a.X,j=a.n,n=a.r;if(y(j)&&y(j.p)&&j.p.e)this.Xa(j);else if(y(j)&&j.e&&this.Xa(j),y(k)&&y(k.p)&&k.p.e)this.B.load(k,a);else if(y(g)&&y(g.p)&&g.p.e)this.B.load(g,a);else{if(y(h)&&C(h))if(y(a.gc)){if(a.gc.Td!=h.length||!a.e)return}else{b=0;c=h.length;for(b=0;b<c;b++)this.B.load(h[b],a);return}else{if(y(h)&&h.e){this.B.load(a,a);return}if(y(n)&&y(n.p)&&n.p.e){this.B.load(n,a);return}}if(0<
a.d.length){h=a.d;k=h.length;for(j=j=0;j<k;j++)this.Xa(h[j])}if(d){for(h=0;this.ud;)h++,window.console.log("Possible thread lock avoided: "+h);this.ud=o;k=a instanceof Ee&&a.bb instanceof Ge;b&&y(g)&&g.e&&(h=this.Bd.get(c),y(h)&&this.a.isBuffer(h.ha)&&this.a.deleteBuffer(h.ha));h=q;y(g)&&(!b||g.e?(h=a.Wb,y(h)||i(Error("Can not add an object and texture without valid coordinate mapping! Set the textureCoordinateMap!")),j=r,g.qa&&(j=o),this.a.pixelStorei(this.a.UNPACK_FLIP_Y_WEBGL,j),j=this.a.createTexture(),
j.vh=g.lb,this.Cd.set(g.na,j),this.a.bindTexture(this.a.TEXTURE_2D,j),g.qa?this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,g.zb,g.yb,0,this.a.RGBA,this.a.UNSIGNED_BYTE,g.qa):this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,this.a.RGBA,this.a.UNSIGNED_BYTE,j.vh),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_S,this.a.CLAMP_TO_EDGE),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_T,this.a.CLAMP_TO_EDGE),k?(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.NEAREST),
this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.NEAREST)):(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.LINEAR),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.LINEAR)),this.a.bindTexture(this.a.TEXTURE_2D,q),j=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,j),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(h),this.a.STATIC_DRAW),h=new Rd(j,h.length,2),g.e=r):h=this.Bd.get(c));Ve(this.B,0.1);if(k)this.ud=
r,I.ya(this.c+".update"),Ve(this.B,0.9);else{if(!b||d.e||l.e){k=l.C;g=k.Na(new Q(d.Pb,d.Qb,d.Rb));k=k.Na(new Q(d.Mb,d.Nb,d.Ob));if(this.Kc===q||g.x<this.Kc)this.Kc=g.x;if(this.Hc===q||k.x>this.Hc)this.Hc=k.x;if(this.Lc===q||g.y<this.Lc)this.Lc=g.y;if(this.Ic===q||k.y>this.Ic)this.Ic=k.y;if(this.Mc===q||g.b<this.Mc)this.Mc=g.b;if(this.Jc===q||k.b>this.Jc)this.Jc=k.b;this.l=[(this.Kc+this.Hc)/2,(this.Lc+this.Ic)/2,(this.Mc+this.Jc)/2];l.e=r}b&&d.e&&(l=this.Sc.get(c),y(l)&&this.a.isBuffer(l.ha)&&this.a.deleteBuffer(l.ha));
l=q;!b||d.e?(l=this.a.createBuffer(),d.zc(),this.a.bindBuffer(this.a.ARRAY_BUFFER,l),this.a.bufferData(this.a.ARRAY_BUFFER,d.I,this.a.STATIC_DRAW),l=new Rd(l,d.count,3),d.e=r):l=this.Sc.get(c);Ve(this.B,0.3);b&&e.e&&(g=this.Sc.get(c),y(g)&&this.a.isBuffer(g.ha)&&this.a.deleteBuffer(g.ha));g=q;!b||e.e?(g=this.a.createBuffer(),e.zc(),this.a.bindBuffer(this.a.ARRAY_BUFFER,g),this.a.bufferData(this.a.ARRAY_BUFFER,e.I,this.a.STATIC_DRAW),g=new Rd(g,e.count,3),e.e=r):g=this.oe.get(c);Ve(this.B,0.3);b&&
f&&f.e&&(e=this.pd.get(c),y(e)&&this.a.isBuffer(e.ha)&&this.a.deleteBuffer(e.ha));e=q;f&&(!b||f.e?(f.length!=d.length&&i(Error("Mismatch between points and point colors.")),e=this.a.createBuffer(),f.zc(),this.a.bindBuffer(this.a.ARRAY_BUFFER,e),this.a.bufferData(this.a.ARRAY_BUFFER,f.I,this.a.STATIC_DRAW),e=new Rd(e,f.count,3),f.e=r):e=this.pd.get(c));Ve(this.B,0.2);b&&n&&n.e&&(f=this.Ad.get(c),y(f)&&this.a.isBuffer(f.ha)&&this.a.deleteBuffer(f.ha));f=q;n&&(f=n.Cc,!b||n.e?(f.length!=d.length&&i(Error("Mismatch between points and scalars.")),
d=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,d),this.a.bufferData(this.a.ARRAY_BUFFER,f,this.a.STATIC_DRAW),f=new Rd(d,f.length,3),n.e=r):f=this.Ad.get(c));Ve(this.B,0.1);b||this.Za.add(a);this.Sc.set(c,l);this.oe.set(c,g);this.pd.set(c,e);this.Bd.set(c,h);this.Ad.set(c,f);this.ud=a.e=r}}else a.e=r}};function pg(a,b){var c=b.g.od,c=a.u.m.Na(b.Xb.C.Na(new Q(c[0],c[1],c[2]))),c=Qc(a.u.pa,c);return Math.round(1E3*c)/1E3}
u.rg=function(a,b){if(this.U.PICKING_ENABLED){this.eb(o,r);var c=new Uint8Array(4);this.a.readPixels(a,this.H-b,1,1,this.a.RGBA,this.a.UNSIGNED_BYTE,c);return c[0]+255*c[1]+65025*c[2]}return-1};
u.eb=function(a,b){ng.k.eb.call(this,a,b);var c=this.Za.t,d=c.length;if(0!=d){a?this.a.bindFramebuffer(this.a.FRAMEBUFFER,this.Af):this.a.bindFramebuffer(this.a.FRAMEBUFFER,q);this.a.viewport(0,0,this.K,this.H);this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);var e=this.u.Rg,f=this.u.Jb;this.a.uniformMatrix4fv(this.Pc.get("perspective"),r,e);this.a.uniformMatrix4fv(this.Pc.get("view"),r,f);e=this.l;this.a.uniform3f(this.Pc.get("center"),parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]));
f=this.Ra.length;for(e=0;e<f;++e){var g=this.Ra[e];if(g instanceof P){var h=new Q(1,0,0),h=this.u.m.Na(h),l=Qc(this.u.pa,h),h=new Q(-1,0,0),h=this.u.m.Na(h),k=Qc(this.u.pa,h),h=new Q(0,1,0),h=this.u.m.Na(h),j=Qc(this.u.pa,h),h=new Q(0,-1,0),h=this.u.m.Na(h),n=Qc(this.u.pa,h),h=new Q(0,0,1),h=this.u.m.Na(h),s=Qc(this.u.pa,h),h=new Q(0,0,-1),h=this.u.m.Na(h),h=Qc(this.u.pa,h),p=Math.max(l,j,s,k,n,h);p==l||p==k?Fe(g,0):p==j||p==n?Fe(g,1):(p==s||p==h)&&Fe(g,2)}}if(this.U.ORDERING_ENABLED){l=r;f=this.Ra;
g=f.length-1;do if(e=f[g],e instanceof P&&e.Ha){k=e.Bb;l=e.P.d;1==k?l=e.Q.d:2==k&&(l=e.$a.d);k=l.length;j=l[0];j.O=pg(this,j);j.V=e.V;n=l[k-1];n.O=pg(this,n);n.V=e.V;n=Math.round(1E3*((n.O-j.O)/k))/1E3;for(s=s=1;s<k-1;s++)h=Math.round(1E3*(j.O+s*n))/1E3,l[s].O=h,l[s].V=e.V;l=o}while(g--);f=this.Za.t;g=f.length-1;do if(e=f[g],e.Ga&&!(1==e.V||e instanceof Ee))e.O=pg(this,e),l=o;while(g--);l&&this.Za.sort()}if(f=!a&&y(b)&&b&&this.U.STATISTICS_ENABLED)var w=0,v=0,z=0,B=0;var e=this.de,g=e.get("vertexPosition"),
l=e.get("vertexNormal"),k=e.get("vertexColor"),j=e.get("vertexTexturePos"),n=e.get("vertexScalar"),e=this.Pc,s=e.get("usePicking"),h=e.get("useObjectColor"),p=e.get("objectColor"),x=e.get("useScalars"),A=e.get("scalarsReplaceMode"),F=e.get("scalarsMin"),N=e.get("scalarsMax"),W=e.get("scalarsMinColor"),G=e.get("scalarsMaxColor"),K=e.get("scalarsInterpolation"),J=e.get("scalarsMinThreshold"),R=e.get("scalarsMaxThreshold"),ga=e.get("objectOpacity"),ya=e.get("labelmapOpacity"),S=e.get("useTexture"),sa=
e.get("useLabelMapTexture"),yc=e.get("textureSampler"),ld=e.get("textureSampler2"),qb=e.get("volumeLowerThreshold"),md=e.get("volumeUpperThreshold"),Jb=e.get("volumeScalarMin"),ib=e.get("volumeScalarMax"),Hb=e.get("volumeWindowLow"),Ac=e.get("volumeWindowHigh"),Ca=e.get("volumeScalarMinColor"),pb=e.get("volumeScalarMaxColor"),zc=e.get("volumeTexture"),kd=e.get("objectTransform"),qg=e.get("pointSize"),e=d;do{var U=c[d-e];if(U){var Y=q;U instanceof Ee&&U.bb&&(Y=U.bb);if(U.Ga&&(!Y||Y.Ga)){var ta=U.na,
Ra=U.Gc,Da=this.Sc.get(ta),$a=this.oe.get(ta),Yd=this.pd.get(ta),Ib=this.Ad.get(ta),ne=this.Bd.get(ta);this.a.bindBuffer(this.a.ARRAY_BUFFER,Da.ha);this.a.vertexAttribPointer(g,Da.qb,this.a.FLOAT,r,0,0);this.a.bindBuffer(this.a.ARRAY_BUFFER,$a.ha);this.a.vertexAttribPointer(l,$a.qb,this.a.FLOAT,r,0,0);a?this.a.uniform1i(s,o):this.a.uniform1i(s,r);Yd&&!a&&!Ra?(this.a.uniform1i(h,r),this.a.bindBuffer(this.a.ARRAY_BUFFER,Yd.ha),this.a.vertexAttribPointer(k,Yd.qb,this.a.FLOAT,r,0,0)):($a=1,Ra&&!a&&($a=
0),this.a.uniform1i(h,$a),$a=U.Fb,a&&($a=[Math.floor(ta%65025%255)/255,Math.floor(ta%65025/255)/255,Math.floor(ta/65025)/255]),this.a.uniform3f(p,parseFloat($a[0]),parseFloat($a[1]),parseFloat($a[2])),this.a.vertexAttribPointer(k,Da.qb,this.a.FLOAT,r,0,0));Ib&&!a&&!Ra?(this.a.uniform1i(x,o),this.a.uniform1i(A,U.r.Cf),ta=U.r.ub,Ra=U.r.sb,this.a.uniform3f(W,parseFloat(ta[0]),parseFloat(ta[1]),parseFloat(ta[2])),this.a.uniform3f(G,parseFloat(Ra[0]),parseFloat(Ra[1]),parseFloat(Ra[2])),this.a.uniform1f(J,
parseFloat(U.r.ba)),this.a.uniform1f(R,parseFloat(U.r.ca)),this.a.uniform1f(F,parseFloat(U.r.Fa)),this.a.uniform1f(N,parseFloat(U.r.Aa)),this.a.uniform1i(K,parseInt(U.r.ge,10)),this.a.bindBuffer(this.a.ARRAY_BUFFER,Ib.ha),this.a.vertexAttribPointer(n,Ib.qb,this.a.FLOAT,r,0,0)):(this.a.uniform1i(x,r),this.a.vertexAttribPointer(n,Da.qb,this.a.FLOAT,r,0,0));this.a.uniform1f(ga,parseFloat(U.V));U.z&&ne&&!a?(this.a.uniform1i(S,o),this.a.activeTexture(this.a.TEXTURE0),this.a.bindTexture(this.a.TEXTURE_2D,
this.Cd.get(U.z.na)),this.a.uniform1i(yc,0),this.a.bindBuffer(this.a.ARRAY_BUFFER,ne.ha),this.a.vertexAttribPointer(j,ne.qb,this.a.FLOAT,r,0,0),this.a.uniform1i(zc,r)):(this.a.uniform1i(S,r),this.a.vertexAttribPointer(j,Da.qb,this.a.FLOAT,r,0,0));Y&&(this.a.uniform1i(zc,o),this.a.uniform1f(qb,Y.ba),this.a.uniform1f(md,Y.ca),this.a.uniform1f(Jb,Y.Fa),this.a.uniform1f(ib,Y.Aa),ta=Y.ub,Ra=Y.sb,this.a.uniform3f(Ca,parseFloat(ta[0]),parseFloat(ta[1]),parseFloat(ta[2])),this.a.uniform3f(pb,parseFloat(Ra[0]),
parseFloat(Ra[1]),parseFloat(Ra[2])),this.a.uniform1f(Hb,Y.ea),this.a.uniform1f(Ac,Y.da),Ib=Y.n,this.a.uniform1i(sa,r),Y.Ha?this.a.uniform1f(ga,parseFloat(Y.V)):Ib&&Ib.Ga&&(Y=U.n.na,this.a.uniform1i(sa,o),this.a.activeTexture(this.a.TEXTURE1),this.a.bindTexture(this.a.TEXTURE_2D,this.Cd.get(Y)),this.a.uniform1i(ld,1),this.a.uniform1f(ya,Ib.V)));this.a.uniformMatrix4fv(kd,r,U.Xb.tf);Y=1;"POINTS"==U.ia&&(Y=U.Nc);this.a.uniform1f(qg,Y);Y=-1;U.ia==od?(Y=this.a.TRIANGLES,f&&(v+=Da.pb/3)):"LINES"==U.ia?
(this.a.lineWidth(U.nc),Y=this.a.LINES,f&&(z+=Da.pb/2)):"POINTS"==U.ia?(Y=this.a.POINTS,f&&(B+=Da.pb)):"TRIANGLE_STRIPS"==U.ia?(Y=this.a.TRIANGLE_STRIP,f&&(v+=Da.pb/3)):"POLYGONS"==U.ia&&(Y=0==Da.pb%3?this.a.TRIANGLES:this.a.TRIANGLE_FAN,f&&(v+=Da.pb/3));f&&(w+=Da.pb);this.a.drawArrays(Y,0,Da.pb)}}}while(--e);f&&(c="Objects: "+d+" | "+("Vertices: "+w+" | ")+("Triangles: "+Math.round(v)+" | "),c=c+("Lines: "+z+" | ")+("Points: "+B+" | ")+("Textures: "+this.Cd.Ua()),window.console.log(c))}};
u.Kd=function(){this.se=q;delete this.se;this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);ng.k.Kd.call(this)};E("X.renderer3D",ng);E("X.renderer3D.prototype.init",ng.prototype.ja);E("X.renderer3D.prototype.add",ng.prototype.add);E("X.renderer3D.prototype.onShowtime",ng.prototype.ng);E("X.renderer3D.prototype.onRender",ng.prototype.lg);E("X.renderer3D.prototype.get",ng.prototype.get);E("X.renderer3D.prototype.render",ng.prototype.fc);E("X.renderer3D.prototype.destroy",ng.prototype.Kd);
E("X.renderer3D.prototype.resetBoundingBox",ng.prototype.ni);E("X.renderer3D.prototype.resetViewAndRender",ng.prototype.gd);E("X.renderer3D.prototype.pick",ng.prototype.rg);function rg(){V.call(this);this.c="mesh";wa(this,new Nc)}H(rg,V);E("X.mesh",rg);function sg(){V.call(this);this.c="fibers";wa(this,new Nc)}H(sg,V);E("X.fibers",sg);function tg(){Pf.call(this);this.c="renderer2D";this.uf=this.he=this.sf=this.fe=this.vb=q;this.zd=this.Tb=this.Ub=this.te=this.ue=0}H(tg,Pf);tg.prototype.$h=aa();tg.prototype.ai=aa();tg.prototype.$e=function(a){tg.k.$e.call(this,a);var b=this.Ra[0];if(b){var c=this.vb;b["index"+c]=a.J?b["index"+c]+1:b["index"+c]-1;eval("this.onScroll();")}};
tg.prototype.bi=function(a){var b=this.Ra[0];if(b){var c=b.da-b.ea,d=c/2,e=parseInt(c+c/15*-a.Hj,10),a=parseInt(d+d/15*a.Gj,10);c==e&&e++;d==a&&a++;b.ea-=parseInt(d-a,10);b.ea-=parseInt(c-e,10);b.ea=Math.max(b.ea,b.Fa);b.da-=parseInt(d-a,10);b.da+=parseInt(c-e,10);b.da=Math.min(b.da,b.Aa);eval("this.onWindowLevel();")}};tg.prototype.__defineGetter__("orientation",t("vb"));
tg.prototype.__defineSetter__("orientation",function(a){a=a.toUpperCase();"X"!=a&&"Y"!=a&&"Z"!=a&&i(Error("Invalid orientation."));this.vb=a});u=tg.prototype;u.ja=function(){this.vb||i(Error("No 2D orientation set."));tg.k.ja.call(this,"2d");this.a.fillStyle="rgba(0,0,0,0)";this.a.fillRect(0,0,this.za.width,this.za.height);this.fe=de("canvas");this.he=de("canvas");M(this.u,Cd,this.bi.bind(this))};u.rotate=function(){this.zd++};u.oi=function(){this.zd--};
u.gd=function(){tg.k.gd.call(this);ug(this);var a=this.Ra[0];a&&(a.da=a.Aa,a.ea=a.Fa)};
u.Xa=function(a){tg.k.Xa.call(this,a);var b=r;this.get(a.na)&&(b=o);var c=a.p,d=a.n,e=a.X;if(y(d)&&y(d.p)&&d.p.e)this.Xa(d);else if(y(e)&&y(e.p)&&e.p.e)this.B.load(e,a);else{if(y(c)&&C(c))if(y(a.gc)){if(a.gc.Td!=c.length||b&&!a.e)return}else{b=0;d=c.length;for(b=0;b<d;b++)this.B.load(c[b],a);return}else if(y(c)&&c.e){this.B.load(a,a);return}var d=c=0,e=a.Y,f=a.D;"X"==this.vb?(this.Vb=a.P.d,c=e[1],d=e[2],this.Ub=f[1],this.Tb=f[2]):"Y"==this.vb?(this.Vb=a.Q.d,c=e[0],d=e[2],this.Ub=f[0],this.Tb=f[2]):
"Z"==this.vb&&(this.Vb=a.$a.d,c=e[0],d=e[1],this.Ub=f[0],this.Tb=f[1]);this.ue=c;this.te=d;e=this.fe;e.width=c;e.height=d;f=this.he;f.width=c;f.height=d;this.sf=e.getContext("2d");this.uf=f.getContext("2d");b||(this.Za.add(a),ug(this))}};function ug(a){a.u.m.j(2,3,Math.min(a.K/(a.ue*a.Ub),a.H/(a.te*a.Tb)))}
u.eb=function(a,b){tg.k.eb.call(this,a,b);if(0!=this.Za.t.length){var c=this.K,d=this.H,e=this.u.m;this.a.save();this.a.clearRect(-c,-d,2*c,2*d);this.a.restore();var f=1*e.S(0,3),g=-1*e.S(1,3),h=Math.max(e.S(2,3),0.6);this.a.setTransform(h,0,0,h,f,g);var e=this.Ra[0],l=this.Vb[parseInt(e["index"+this.vb],10)],k=l.z.qa,l=l.n,j=q;l&&(j=l.qa);var n=this.ue,s=this.te,p=this.sf,w=this.uf,v=p.getImageData(0,0,n,s),z=w.getImageData(0,0,n,s),B=v.data,x=z.data,A=B.length,F=e.Aa,N=e.ba,W=e.ca,G=0,K=0;if(0<
this.wd*this.xd){if(this.K/this.H<n/s)var J=n/this.K,G=(this.H-s/J)/2,K=this.xd-G,K=K*J,G=this.wd*J;else J=s/this.H,G=(this.K-n/J)/2,G=this.wd-G,G*=J,K=this.xd*J;0<G*K&&(G=Math.floor(G+0.5),K=Math.floor(K+0.5))}J=0;do{var R=[0,0,0,0],ga=[0,0,0,0],ya=k[J]/255*F,S=k[J],sa=e.ea/F,S=(S/255-sa)/(e.da/F-sa),S=255*S;ya>=N&&ya<=W&&(R=new Q(e.ub[0],e.ub[1],e.ub[2]),R=(new Q(e.sb[0],e.sb[1],e.sb[2])).scale(S).add(R.scale(255-S)),R=[Math.floor(R.x),Math.floor(R.y),Math.floor(R.b),255],l&&(ga=[j[J],j[J+1],j[J+
2],j[J+3]]));S=A-1-J;0<G*K&&(K-1)*n+G==Math.ceil(S/4)?(B[S-3]=255,B[S-2]=255,B[S-1]=0,B[S]=255):(B[S-3]=R[0],B[S-2]=R[1],B[S-1]=R[2],B[S]=R[3]);x[S-3]=ga[0];x[S-2]=ga[1];x[S-1]=ga[2];x[S]=ga[3];J+=4}while(J<A);p.putImageData(v,0,0);w.putImageData(z,0,0);this.a.globalAlpha=1;this.a.translate(c/2/h,d/2/h);this.a.rotate(0.5*Math.PI*this.zd);switch(this.zd%4){case 1:c=f;f=g;g=-c;break;case 2:f*=-1;g*=-1;break;case 3:c=f,f=-g,g=c}f=-n*this.Ub/2+f;g=-s*this.Tb/2+g;this.a.drawImage(this.fe,f,g,n*this.Ub,
s*this.Tb);l&&e.n.Ga&&(this.a.globalAlpha=e.n.V,this.a.drawImage(this.he,f,g,n*this.Ub,s*this.Tb))}};E("X.renderer2D",tg);E("X.renderer2D.prototype.init",tg.prototype.ja);E("X.renderer2D.prototype.add",tg.prototype.add);E("X.renderer2D.prototype.onShowtime",tg.prototype.ng);E("X.renderer2D.prototype.onRender",tg.prototype.lg);E("X.renderer2D.prototype.onScroll",tg.prototype.$h);E("X.renderer2D.prototype.onWindowLevel",tg.prototype.ai);E("X.renderer2D.prototype.get",tg.prototype.get);
E("X.renderer2D.prototype.rotate",tg.prototype.rotate);E("X.renderer2D.prototype.rotateCounter",tg.prototype.oi);E("X.renderer2D.prototype.resetViewAndRender",tg.prototype.gd);E("X.renderer2D.prototype.render",tg.prototype.fc);E("X.renderer2D.prototype.destroy",tg.prototype.Kd);
